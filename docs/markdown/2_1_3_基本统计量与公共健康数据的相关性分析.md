> Last updated on Sat Oct 22 2022 @author: Richie Bao

## 2.1.3 åŸºæœ¬ç»Ÿè®¡é‡ä¸å…¬å…±å¥åº·æ•°æ®çš„ç›¸å…³æ€§åˆ†æ

### 2.1.3.1  åŸºæœ¬ç»Ÿè®¡é‡ï¼šæ ‡å‡†è¯¯ã€ä¸­å¿ƒæé™å®šç†ã€tåˆ†å¸ƒã€ç»Ÿè®¡æ˜¾è‘—æ€§ã€æ•ˆåº”é‡å’Œç½®ä¿¡åŒºé—´ <sup>[1][2]</sup>

#### 1ï¼‰æ ‡å‡†è¯¯

å®šä¹‰ï¼šæ ‡å‡†è¯¯æ˜¯æŸä¸€ç»Ÿè®¡é‡ï¼ˆä¾‹å¦‚å‡å€¼ã€ä¸¤ä¸ªå‡å€¼åªå·®ã€ç›¸å…³ç³»æ•°ç­‰ï¼‰æŠ½æ ·åˆ†å¸ƒï¼ˆsampling distributionï¼‰çš„æ ‡å‡†å·®ï¼ˆå³æ ·æœ¬å‡å€¼çš„æ ‡å‡†å·®ï¼Œè€Œä¸æ˜¯æ ·æœ¬çš„æ ‡å‡†å·®ï¼‰ï¼Œåº¦é‡äº†ä»åŒä¸€æ€»ä½“ä¸­æŠ½å–ç›¸åŒå®¹é‡æ ·æœ¬çš„é¢„æœŸéšæœºå·®å¼‚ã€‚åœ¨ä¸‹è¿°ä»£ç ä¸­ï¼Œä»æœä»å¹³å‡å€¼ä¸º30ï¼Œæ ‡å‡†å·®ä¸º5çš„æ­£æ€åˆ†å¸ƒä¸­ï¼Œéšæœºæå–2000ä¸ªæ ·æœ¬ï¼ˆsampleï¼‰ï¼Œå„ä¸ªæ ·æœ¬å®¹é‡ä¸º1000ï¼Œå¹¶è®¡ç®—æ¯ä¸€æ ·æœ¬çš„å‡å€¼ï¼ŒæŸ¥çœ‹è¿™2000ä¸ªæ ·æœ¬çš„å‡å€¼åˆ†å¸ƒï¼Œå³å‡å€¼æŠ½æ ·åˆ†å¸ƒï¼ˆsampling distribution of the meanï¼‰ã€‚æ™®é€šåˆ†å¸ƒå…·æœ‰å‡å€¼å’Œæ ‡å‡†å·®ï¼Œåœ¨å‡å€¼çš„æŠ½æ ·åˆ†å¸ƒä¸­ï¼Œå‡å€¼åˆ™ç§°ä¸ºå‡å€¼çš„æœŸæœ›å€¼ï¼ˆexpected value of the meanï¼‰ï¼Œè¿™æ˜¯å› ä¸ºæ ·æœ¬å‡å€¼çš„æœ€ä½³çŒœæµ‹ä¸æ€»ä½“å‡å€¼ä¸€è‡´ã€‚ä¸‹è¿°ä»£ç ä¸­è®¡ç®—äº†å‡å€¼æŠ½æ ·åˆ†å¸ƒçš„å‡å€¼å‡ ä¹ä¸æ€»ä½“ï¼ˆpopulationï¼‰ä¸€æ ·ï¼Œè¯æ˜äº†è¿™ä¸€ç‚¹ã€‚å‡å€¼æŠ½æ ·åˆ†å¸ƒçš„æ ‡å‡†å·®åˆ™ç§°ä¸ºæ ‡å‡†è¯¯ã€‚æ ‡å‡†å·®æ˜¯åˆ†å¸ƒä¸­çš„å•ä¸ªå–å€¼ä¸åˆ†å¸ƒå‡å€¼ä¹‹é—´çš„å¹³å‡å·®å¼‚æˆ–å¹³å‡ç¦»å·®ï¼Œå‡å€¼çš„æ ‡å‡†è¯¯æä¾›äº†åŒæ ·çš„ä¿¡æ¯ï¼Œåªæ˜¯å•ä¸ªæ ·æœ¬å‡å€¼ä¸å…¶æœŸæœ›å€¼ä¹‹é—´çš„å¹³å‡å·®å¼‚ï¼Œå¯ä»¥ç†è§£ä¸ºå¯¹æ ·æœ¬å‡å€¼ä»£è¡¨å®é™…æ€»ä½“å‡å€¼çš„ç¡®ä¿¡ç¨‹åº¦ï¼Œæœ‰åŠ©äºç¡®å®šæ ·æœ¬ç»Ÿè®¡å€¼ï¼ˆä¾‹å¦‚æ ·æœ¬å‡å€¼ï¼‰ä¸æ€»ä½“å‚æ•°ï¼ˆä¾‹å¦‚æ€»ä½“å‡å€¼ï¼‰ä¹‹é—´çš„å·®å¼‚æ˜¯å¦æœ‰æ„ä¹‰ã€‚åŒæ—¶è®¡ç®—äº†å‡å€¼æŠ½æ ·åˆ†å¸ƒæ ‡å‡†è®¡åˆ†çš„K-S testæ­£æ€æ€§æ£€éªŒï¼Œæ¯æ¬¡ä»£ç è¿è¡Œäº§ç”Ÿçš„æ•°æ®æ˜¯ç¬¦åˆä¸Šè¿°æ¡ä»¶ä¸‹çš„éšæœºå€¼ï¼Œå…¶p-valueæ˜¯å˜åŒ–çš„ï¼Œä½†é€šå¸¸é«˜äº0.5ï¼Œå³>0.05ï¼Œå› æ­¤å¯ä»¥åˆ¤æ–­å‡å€¼æŠ½æ ·åˆ†å¸ƒç¬¦åˆæ­£æ€åˆ†å¸ƒã€‚

å‡å€¼æ ‡å‡†è¯¯çš„è®¡ç®—å…¬å¼ï¼š

 $\sigma _{ \overline{x} }= \frac{ \sigma }{ \sqrt{n} } $æˆ– $S _{ \overline{x} }= \frac{s }{ \sqrt{n} }$ï¼Œå¼ä¸­$\sigma$ä¸ºæ€»ä½“æ ‡å‡†å·®ï¼Œ$s$ä¸ºæ ‡å‡†å·®çš„æ ·æœ¬ä¼°è®¡ï¼Œ$n$ä¸ºæ ·æœ¬å®¹é‡ã€‚å› ä¸ºé€šå¸¸$\sigma$æ€»ä½“çš„æ ‡å‡†å·®æœªçŸ¥ï¼Œå› æ­¤ç”¨æ ‡å‡†å·®çš„æ ·æœ¬ä¼°è®¡ï¼Œè®¡ç®—æ ‡å‡†è¯¯ã€‚


```python
import numpy as np
from scipy import stats
import seaborn as sns
import math

sns.set()
mu,sigma=30,5
sample_size=1000
sample_mus=np.array([np.random.normal(mu, sigma, sample_size).mean() for i in range(2000)]) # ä»æœä»å¹³å‡å€¼ä¸º30ï¼Œæ ‡å‡†å·®ä¸º5çš„æ­£æ€åˆ†å¸ƒä¸­ï¼Œéšæœºæå–2000ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬å®¹é‡ä¸º1000çš„æ ·æœ¬ï¼Œå¹¶è®¡ç®—æ¯ä¸€æ ·æœ¬çš„å‡å€¼
bins=30
sns.histplot(sample_mus,bins=bins,kde=True,stat="density", linewidth=0) # æŸ¥çœ‹2000ä¸ªæ ·æœ¬å‡å€¼åˆ†å¸ƒ
print("sample_mus mu:%.2f,sigma:%.2f"%(sample_mus.mean(),sample_mus.std()))
kstest_test=stats.kstest(stats.zscore(sample_mus),cdf='norm')
print("sampling distribution of the mean - K-S test statistic:%.2f,p-value:%.2f"%kstest_test)
print("standard error of mean:",sample_mus.std()/math.sqrt(sample_size) ) # è®¡ç®—æ ‡å‡†è¯¯
print("standard error of mean_scipy.stats.sem():",stats.sem(sample_mus,ddof=0)) # ä½¿ç”¨scipy.statsåº“ç›´æ¥è®¡ç®—æ ‡å‡†è¯¯
```

    sample_mus mu:30.00,sigma:0.16
    sampling distribution of the mean - K-S test statistic:0.02,p-value:0.41
    standard error of mean: 0.0049183131322453714
    standard error of mean_scipy.stats.sem(): 0.0034777725678095507
    


<img src="./imgs/2_1_3/output_2_1.png" height='auto' width='auto' title="caDesign">   
    


å•ä¸ªæ ·æœ¬çš„å®¹é‡è¶Šå¤§ï¼Œå°±è¶Šæ¥è¿‘äºæ€»ä½“ï¼Œå‡å€¼æŠ½æ ·åˆ†å¸ƒçš„å‡å€¼è¶Šè¶‹è¿‘äºæ€»ä½“å‡å€¼ï¼Œè€Œå…¶æ ‡å‡†å·®å³æ ‡å‡†è¯¯è¶Šå°ï¼Œè¡¨æ˜æ ·æœ¬å‡å€¼çš„ç»Ÿè®¡é‡ï¼ˆæˆ–è®¡ç®—å…¶å®ƒçš„ç»Ÿè®¡é‡ï¼‰èƒ½å¤Ÿä»£è¡¨è¯¥æ€»ä½“çš„ç»Ÿè®¡é‡ï¼Œå¯¹æ€»ä½“çš„ä¼°è®¡ä¹Ÿå°±è¶Šå‡†ç¡®ã€‚åˆ©ç”¨ä¸‹è¿°ä»£ç åˆ†æä¸Šè¿°è§‚ç‚¹ï¼Œè®¡ç®—å¤šä¸ªä¸ç”¨æ ·æœ¬å®¹é‡å‡å€¼æŠ½æ ·åˆ†å¸ƒçš„æ ‡å‡†è¯¯ï¼Œéšç€æ ·æœ¬å®¹é‡çš„å¢åŠ ï¼Œæ ‡å‡†è¯¯è¿…é€Ÿçš„å‡å°åé€æ­¥è¶‹äºç¼“å’Œï¼Œè¯´æ˜å•ä¸ªæ ·æœ¬å®¹é‡è¶Šå¤§ï¼Œè¶Šæ¥è¿‘æ€»ä½“ï¼Œå¯¹æ€»ä½“çš„ä¼°è®¡è¶Šå‡†ç¡®ã€‚


```python
import matplotlib.pyplot as plt 

sample_mu_list=[]
sample_sigma_list=[]
sample_size_list=list(range(10,2000,20))
for sample_size in sample_size_list:
    sample_size_mu=np.array([np.random.normal(mu, sigma, sample_size).mean() for i in range(2000)])
    sample_mu_list.append(sample_size_mu.mean())
    sample_sigma_list.append(sample_size_mu.std())
ax=sns.lineplot(x=sample_size_list,y=sample_sigma_list)  
ax.set(xlabel='sample_size',ylabel='sample_sigma')
plt.show()
```


<img src="./imgs/2_1_3/output_4_0.png" height='auto' width='auto' title="caDesign">   


#### 2ï¼‰ä¸­å¿ƒæé™å®šç†

ä¸­å¿ƒæé™å®šä¹‰ï¼ˆcentral limit theoremï¼‰è¡¨æ˜ï¼Œåªè¦æ ·æœ¬å®¹é‡è¶³å¤Ÿå¤§ï¼Œå³ä½¿æ ·æœ¬å–å€¼çš„æ€»ä½“åˆ†å¸ƒä¸æ˜¯æ­£æ€åˆ†å¸ƒï¼Œå‡å€¼çš„æŠ½æ ·åˆ†å¸ƒä¹Ÿæœä»æ­£æ€åˆ†å¸ƒã€‚æˆ–ç†è§£ä¸ºä¸ç®¡æ ·æœ¬æ€»ä½“æœä»ä»€ä¹ˆåˆ†å¸ƒï¼Œå½“æ ·æœ¬æ•°é‡è¶³å¤Ÿå¤§æ—¶ï¼Œæ ·æœ¬çš„å‡å€¼ä»¥æ­£æ€åˆ†å¸ƒçš„å½¢å¼å›´ç»•æ€»ä½“å‡å€¼æ³¢åŠ¨ã€‚ä¸ºéªŒè¯ä¸­å¿ƒæé™ï¼Œä½¿ç”¨ç™¾åº¦POIæ•°æ®ï¼Œæå–ç¾é£Ÿçš„ä»·æ ¼æ•°æ®ã€‚åœ¨æ­£æ€åˆ†å¸ƒä¸æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸€èŠ‚ï¼Œå·²ç»é€šè¿‡æ­£æ€æ€§æ£€éªŒç¡®å®šäº†è¯¥ç¾é£Ÿä»·æ ¼æ•°æ®é›†ä¸ºéæ­£æ€åˆ†å¸ƒï¼Œä¸‹è¿°ä»£ç é‡ç°äº†K-S testæ­£æ€æ€§æ£€éªŒï¼Œp-value=5.153632014592587e-26ï¼Œå°äº0.05ï¼Œæ‹’ç»åŸå‡è®¾ï¼Œå³ä¸ç¬¦åˆæ­£æ€åˆ†å¸ƒã€‚ä»è¯¥æ•°æ®é›†ä¸­éšæœºæŠ½å–å•ä¸ªæ ·æœ¬å®¹é‡ä¸º350ï¼Œæ€»å…±2000ä¸ªæ ·æœ¬ï¼Œè®¡ç®—å‡å€¼æŠ½æ ·åˆ†å¸ƒåçš„K-S testæ­£æ€æ€§æ£€éªŒï¼Œå…¶å€¼p-valueé€šå¸¸å¤§äº0.5ï¼Œè¡¨æ˜å‡å€¼æŠ½æ ·åˆ†å¸ƒä¸ºæ­£æ€åˆ†å¸ƒï¼Œæ»¡è¶³ä¸­å¿ƒæé™å®šä¹‰ã€‚

å¾ˆå¤šç»Ÿè®¡é‡éƒ½ä¾èµ–äºä»æ­£æ€åˆ†å¸ƒä¸­å¾—åˆ°æ¦‚ç‡ï¼Œè€Œä¸­å¿ƒæé™å®šç†ç¡®å®šäº†è¶³å¤Ÿå¤šçš„æ ·æœ¬å‡å€¼æœä»æ­£æ€åˆ†å¸ƒï¼ˆå³ä½¿æ€»ä½“åˆ†å¸ƒä¸æ˜¯æ­£æ€çš„ï¼‰ï¼Œå³å‡å€¼æŠ½æ ·åˆ†å¸ƒä¸ºæ­£æ€åˆ†å¸ƒï¼Œå› æ­¤è¿™ä¸€å®šç†ä½¿å¾—ä¼—å¤šç»Ÿè®¡é‡çš„æ¦‚ç‡è®¡ç®—æˆä¸ºå¯èƒ½ã€‚


```python
import util_misc
import pandas as pd

poi_gpd=pd.read_pickle('./data/poisInAll/poisInAll_gdf.pkl') # è¯»å–å·²ç»å­˜å‚¨ä¸º.pklæ ¼å¼çš„POIæ•°æ®ï¼Œå…¶ä¸­åŒ…æ‹¬geometryå­—æ®µï¼Œä¸ºGeoDataFrameåœ°ç†ä¿¡æ¯æ•°æ®ï¼Œå¯ä»¥é€šè¿‡poi_gpd.plot()è¿…é€ŸæŸ¥çœ‹æ•°æ®ã€‚
delicacy_price=poi_gpd.xs('poi_0_delicacy',level=0).detail_info_price  # æå–ç¾é£Ÿä»·æ ¼æ•°æ®
delicacy_price_df=delicacy_price.to_frame(name='price').astype(float) 
delicacy_price_df_clean=delicacy_price_df.dropna()
_,delicacyPrice_outliersDrop=util_misc.is_outlier(delicacy_price_df_clean.price,threshold=3.5) # å°†å¼‚å¸¸å€¼å¤„ç†å‡½æ•°æ”¾ç½®äºutil_misc.pyæ–‡ä»¶ä¸­ï¼Œç›´æ¥è°ƒç”¨ã€‚è§å¼‚å¸¸å€¼å¤„ç†ä¸€èŠ‚

delicacy_price_array_dropna=delicacyPrice_outliersDrop.to_numpy().reshape(-1)
print("original data mean:%.2f"%delicacy_price_array_dropna.mean())

print("original data K-S test:",stats.kstest(stats.zscore(delicacy_price_array_dropna),cdf='norm')) # è®¡ç®—æ ‡å‡†åŒ–åçš„K-S testæ­£æ€æ€§æ£€éªŒ

delicacy_price_sample_mus=np.array([np.random.choice(delicacy_price_array_dropna,350).mean() for i in range(2000)])
sns.histplot(delicacy_price_sample_mus,bins=bins,kde=True,stat="density", linewidth=0)
print("sample_mus mu:%.2f,sigma:%.2f"%(delicacy_price_sample_mus.mean(),delicacy_price_sample_mus.std()))
kstest_test=stats.kstest(stats.zscore(delicacy_price_sample_mus),cdf='norm')
print("sample_mus K-S test statistic:%.2f,p-value:%.2f"%kstest_test)
```

    original data mean:47.70
    original data K-S test: KstestResult(statistic=0.11464960111854455, pvalue=5.153632014592587e-26)
    sample_mus mu:47.76,sigma:1.69
    sample_mus K-S test statistic:0.01,p-value:0.76
    


<img src="./imgs/2_1_3/output_6_1.png" height='auto' width='auto' title="caDesign">    
   


#### 3ï¼‰tåˆ†å¸ƒ (Student's t-distribution)

å¦‚æœè¦ä½¿ç”¨æ­£æ€åˆ†å¸ƒï¼Œé€šè¿‡z-scoreï¼ˆæ ‡å‡†è®¡åˆ†ï¼‰è·å¾—ç²¾ç¡®æ¦‚ç‡ï¼Œè‡³å°‘éœ€è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼Œä¸€ä¸ªæ˜¯ï¼Œ$\sigma$æ€»ä½“æ ‡å‡†å·®å·²çŸ¥ï¼›å¦ä¸€ä¸ªæ˜¯ï¼Œå¤§æ ·æœ¬ï¼ˆå³æ ·æœ¬å®¹é‡è¶³å¤Ÿå¤§ï¼‰ã€‚å¦‚æœä¸Šè¿°æ¡ä»¶å‡ä¸æ»¡è¶³ï¼Œåˆ™éœ€è¦è€ƒè™‘æ ·æœ¬å®¹é‡ï¼Œè¿™å°±ç”¨åˆ°tåˆ†å¸ƒã€‚tåˆ†å¸ƒçš„å½¢çŠ¶å—æ ·æœ¬å®¹é‡å½±å“ï¼Œå¤§æ ·æœ¬æ¡ä»¶ä¸‹ï¼Œtåˆ†å¸ƒä¸æ­£æ€åˆ†å¸ƒçš„å½¢çŠ¶å‡ ä½•å®Œå…¨ä¸€æ ·ï¼Œè€Œéšæ ·æœ¬å®¹é‡å‡å°‘ï¼Œtåˆ†å¸ƒçš„å½¢çŠ¶å˜å¾—ä¸­é—´æ›´å¹³å¦ï¼Œä¸¤ç«¯æ›´ç²—åšï¼Œå³å‡å€¼å‘¨å›´çš„å–å€¼å˜å¾—æ›´å°‘ï¼Œè€Œè¿œç¦»å‡å€¼ï¼Œä½äºåˆ†å¸ƒå°¾éƒ¨çš„å–å€¼å˜å¾—æ›´å¤šã€‚ä»¥`SciPy`åº“[scipy.stats.t](https://docs.scipy.org/doc/scipy-0.13.0/reference/generated/scipy.stats.t.html)<sup>â‘ </sup>ç»™å‡ºçš„æ¡ˆä¾‹æ¥è§‚å¯Ÿtåˆ†å¸ƒï¼Œå…¶ä»£ç æ–¹æ³•ä¸æ­£æ€åˆ†å¸ƒåŸºæœ¬ç›¸åŒï¼Œå¯ä»¥äº’ç›¸æ¯”è¾ƒæŸ¥çœ‹ä¹‹é—´çš„å·®å¼‚ã€‚

tåˆ†å¸ƒä¸­ï¼Œå¢åŠ äº†ä¸€ä¸ªæ–°çš„å‚æ•°è‡ªç”±åº¦ï¼ˆdegree of freedomï¼Œdfï¼‰ï¼Œé€šå¸¸ç”¨ç¬¦å·$\nu $æ¥è¡¨ç¤ºï¼Œå½“ä»¥æ ·æœ¬çš„ç»Ÿè®¡é‡æ¥ä¼°è®¡æ€»ä½“çš„å‚æ•°æ—¶ï¼Œå¯¹Nä¸ªéšæœºæ ·æœ¬è€Œè¨€ï¼Œå…¶è‡ªç”±åº¦ä¸ºN-1ã€‚

æ•°æ®é›†ä¸ºæ­£æ€åˆ†å¸ƒï¼Œç»™å®šä¸€ä¸ªå–å€¼ï¼Œè®¡ç®—è¯¥å–å€¼çš„z-scoreåï¼Œå°±å¯ä»¥è·å¾—è¯¥å–å€¼çš„æ¦‚ç‡ã€‚è€Œåœ¨tåˆ†å¸ƒä¸‹ï¼Œè¦è·å–å¯¹åº”å–å€¼çš„æ¦‚ç‡ï¼Œåˆ™éœ€è¦è®¡ç®—tå€¼ï¼ˆtç»Ÿè®¡é‡ï¼‰ï¼Œå…¶å…¬å¼å®šä¹‰ä¸ºï¼š$t= \frac{ \overline{X} - \mu }{S _{ \overline{x} }} $ï¼Œå¼ä¸­$\mu$ä¸ºæ€»ä½“å‡å€¼ï¼Œ$\overline{X}$ä¸ºæ ·æœ¬å‡å€¼ï¼Œ${S _{ \overline{x} }}$ä¸ºæ ‡å‡†è¯¯çš„æ ·æœ¬ä¼°è®¡ã€‚çŸ¥é“tå€¼ï¼ŒåŠè‡ªç”±åº¦ï¼ˆæ ·æœ¬å®¹é‡N-1ï¼‰ï¼Œå¯ä»¥æŸ¥tå€¼è¡¨å¾—åˆ°è¯¥å–å€¼çš„æ¦‚ç‡ã€‚å½“ç„¶ï¼Œç›®å‰ç›´æ¥ä½¿ç”¨`SciPy`ç­‰åº“è®¡ç®—ï¼Œæ— éœ€å†è®¡ç®—tå€¼å†å¯¹åº”æŸ¥è¡¨ã€‚


```python
from scipy.stats import norm
from scipy.stats import t
import matplotlib.pyplot as plt
import numpy as np

fig, ax=plt.subplots(1, 1)
df=2.75 # é…ç½®è‡ªç”±åº¦
mean, var, skew, kurt=t.stats(df, moments='mvsk') # æŸ¥çœ‹æœä»tåˆ†å¸ƒçš„ç›¸å…³ç»Ÿè®¡é‡
print('mean, var, skew, kurt=',(mean, var, skew, kurt))

x=np.linspace(t.ppf(0.01, df),t.ppf(0.99, df), 100) # è·å–æœä»è‡ªç”±åº¦dfï¼Œæ¦‚ç‡ä½äº1%åˆ°99%çš„100ä¸ªå–å€¼
ax.plot(x, t.pdf(x, df),'r-', lw=5, alpha=0.6, label='t_%.2f pdf'%df)

rv=t(df) # æŒ‡å®šå›ºå®šè‡ªç”±åº¦çš„éšæœºå˜é‡ï¼ˆrandom variableï¼‰åºåˆ—
ax.plot(x, rv.pdf(x), 'k-', lw=2, label='t_%.2f frozen pdf'%df)

rv_df_02=t(0.2) # æŒ‡å®šå›ºå®šè‡ªç”±åº¦ä¸º0.2çš„éšæœºå˜é‡åºåˆ—
ax.plot(x, rv_df_02.pdf(x), 'g-', lw=2, label='t_0.2 pdf')

vals=t.ppf([0.001, 0.5, 0.999], df) # è¿”å›æ¦‚ç‡ä¸º0.1%ã€50%å’Œ99.9%çš„å–å€¼
print("éªŒè¯ç´¯ç§¯åˆ†å¸ƒå‡½æ•°CDFè¿”å›å€¼ä¸å…¶PPFè¿”å›å€¼æ˜¯å¦ç›¸ç­‰æˆ–è¿‘ä¼¼ï¼š",np.allclose([0.001, 0.5, 0.999], t.cdf(vals, df)))

rv_1000=t.rvs(df, size=1000) # è·å–æœä»è‡ªç”±åº¦dfçš„1000ä¸ªéšæœºå–å€¼
ax.hist(rv_1000, density=True, histtype='stepfilled', alpha=0.2)

# æ¯”è¾ƒæ ‡å‡†æ­£æ€åˆ†å¸ƒ
x_nd=np.linspace(norm.ppf(0.01),norm.ppf(0.99), 100)
ax.plot(x_nd, norm.pdf(x_nd), 'b--', lw=2, alpha=0.8, label='norm pdf')
ax.legend(loc='best', frameon=False)
plt.show()
```

    mean, var, skew, kurt= (array(0.), array(3.66666667), array(nan), array(inf))
    éªŒè¯ç´¯ç§¯åˆ†å¸ƒå‡½æ•°CDFè¿”å›å€¼ä¸å…¶PPFè¿”å›å€¼æ˜¯å¦ç›¸ç­‰æˆ–è¿‘ä¼¼ï¼š True
    


<img src="./imgs/2_1_3/output_8_1.png" height='auto' width='auto' title="caDesign">    


```python
# å¦‚æœéœ€è¦è®¡ç®—æœä»tåˆ†å¸ƒçš„æ¦‚ç‡åˆ™æŒ‡å®šdfï¼ŒåŠlocï¼ˆå‡å€¼ï¼Œé»˜è®¤ä¸º0ï¼‰å’Œscale(æ ‡å‡†å·®ï¼Œé»˜è®¤ä¸º1)
print("ç”¨.cdfè®¡ç®—å€¼å°äºæˆ–ç­‰äº113çš„æ¦‚ç‡ä¸ºï¼š",t.cdf(113,df=999,loc=100,scale=12)) 
print("ç”¨.sfè®¡ç®—å€¼å¤§äºæˆ–ç­‰äº113å¾…æ¦‚ç‡ä¸ºï¼š",t.sf(113,df=999,loc=100,scale=12)) 
print("å¯ä»¥è§‚å¯Ÿåˆ°.cdfï¼ˆ<=113ï¼‰æ¦‚ç‡ç»“æœ+.sf(>=113)æ¦‚ç‡ç»“æœä¸ºï¼š",t.cdf(113,df=999,loc=100,scale=12)+t.sf(113,df=999,loc=100,scale=12))
print("ç”¨.ppfæ‰¾åˆ°ç»™å®šæ¦‚ç‡å€¼ä¸º98%çš„æ•°å€¼ä¸ºï¼š",t.ppf(0.81766,df=999,loc=100,scale=12))
```

    ç”¨.cdfè®¡ç®—å€¼å°äºæˆ–ç­‰äº113çš„æ¦‚ç‡ä¸ºï¼š 0.8605390547558804
    ç”¨.sfè®¡ç®—å€¼å¤§äºæˆ–ç­‰äº113å¾…æ¦‚ç‡ä¸ºï¼š 0.13946094524411956
    å¯ä»¥è§‚å¯Ÿåˆ°.cdfï¼ˆ<=113ï¼‰æ¦‚ç‡ç»“æœ+.sf(>=113)æ¦‚ç‡ç»“æœä¸ºï¼š 1.0
    ç”¨.ppfæ‰¾åˆ°ç»™å®šæ¦‚ç‡å€¼ä¸º98%çš„æ•°å€¼ä¸ºï¼š 110.88276310459135
    

#### 4ï¼‰ç»Ÿè®¡æ˜¾è‘—æ€§
ä½¿ç”¨`SciPy`åº“å»ºç«‹æœä»å‡å€¼ä¸º100ï¼Œæ ‡å‡†å·®ä¸º12çš„æ­£æ€åˆ†å¸ƒã€‚ç»˜åˆ¶æ ·æœ¬å®¹é‡ä¸º1000çš„å•ä¸ªæ ·æœ¬çš„éšæœºå–å€¼åˆ†å¸ƒï¼›åŒæ—¶ç»˜åˆ¶æ ·æœ¬å®¹é‡ä¸º1000ï¼Œæ ·æœ¬æ•°ä¸º2000çš„å‡å€¼æŠ½æ ·åˆ†å¸ƒã€‚è®¡ç®—2000ä¸ªæ ·æœ¬å‡å€¼æŠ½æ ·åˆ†å¸ƒçš„æ ‡å‡†å·®ï¼Œå°†å…¶ä½œä¸ºç»˜åˆ¶tåˆ†å¸ƒçš„æ ‡å‡†å·®ï¼Œå‡å€¼ä¿æŒä¸å˜ä¸º100ï¼Œè‡ªç”±åº¦ä¸º1999ï¼ˆå³æ ·æœ¬å®¹é‡ä¸º2000ï¼Œç­‰äºå‡å€¼æŠ½æ ·åˆ†å¸ƒçš„æ ·æœ¬æ•°é‡ï¼‰ã€‚è§‚å¯Ÿå‡å€¼æŠ½æ ·åˆ†å¸ƒä¸å¯¹åº”çš„tåˆ†å¸ƒï¼ˆåŒå‡å€¼å’Œæ ‡å‡†å·®ï¼ŒåŠè‡ªç”±åº¦ä¸ºå‡å€¼æŠ½æ ·åˆ†å¸ƒçš„æ ·æœ¬æ•°ï¼‰ï¼Œæ›²çº¿å½¢çŠ¶åŸºæœ¬ä¿æŒä¸€è‡´ï¼Œå†ä¸€æ¬¡éªŒè¯ä¸­å¿ƒæé™å®šç†ã€‚åœ¨è¿™æ ·æœ¬å®¹é‡ä¸º1000çš„2000ä¸ªæ ·æœ¬ä¸­ï¼Œå¯ä»¥ä¾æ®tåˆ†å¸ƒä¼°è®¡æ ·æœ¬å‡å€¼æ¦‚ç‡å°äº0.05ï¼ˆ5%ï¼‰çš„å–å€¼ä¸º 99.387ï¼Œå¤§äº0.95ï¼ˆ95%ï¼‰çš„å–å€¼ä¸º100.641ã€‚å°±æ­¤æˆ‘ä»¬èƒ½å¤Ÿä¼°è®¡å–å€¼å°äº99.387æˆ–è€…å¤§äº100.641çš„æ ·æœ¬å‡å€¼å‡ºç°çš„æ¦‚ç‡ï¼ˆæœºç‡ï¼‰å°äº5%ï¼ˆ0.05ï¼‰ã€‚

å¦‚æœæˆ‘ä»¬ä¸æ˜¯æ ¹æ®æ¦‚ç‡è·å–å¯¹åº”çš„å–å€¼ï¼ˆå³æ ·æœ¬å‡å€¼ï¼‰ï¼Œè€Œæ˜¯ä¼°è®¡å–å€¼çš„æ¦‚ç‡ï¼Œä¾‹å¦‚ä¼°è®¡æ ·æœ¬å‡å€¼å°äºæˆ–è€…ç­‰äº99.0çš„æ¦‚ç‡ä¸ºå¤šå°‘ï¼Œè®¡ç®—ç»“æœä¸º0.00439ã€‚è¿™ä¸ªæ¦‚ç‡å€¼æ˜¯å¦èƒ½ç¡®å®šæ ·æœ¬ç»Ÿè®¡é‡ï¼ˆä¾‹å¦‚æ ·æœ¬å‡å€¼ï¼‰ä¸æ€»ä½“å‚æ•°ï¼ˆä¾‹å¦‚æ€»ä½“å‡å€¼ï¼‰ä¹‹é—´æŸç§å·®å¼‚ï¼ˆä¾‹å¦‚æ ·æœ¬å‡å€¼ä¸º99.0ï¼Œè€Œæ€»ä½“å‡å€¼ä¸º100ï¼Œ100-99.0=1.0çš„å·®å¼‚ï¼‰ï¼Œæ˜¯å¦ä»…ä»…ç”±éšæœºæŠ½æ ·è¯¯å·®æˆ–å¶ç„¶å› ç´ å¯¼è‡´ï¼Ÿæƒ¯ä¾‹æ˜¯å–æ¦‚ç‡På€¼p-value=0.05ä½œä¸ºä¸€ä¸ªæ°´å¹³çš„ç•Œé™ã€‚è¿™ä¸€æ°´å¹³å°±ä¸ºï¼Œå½“åŸå‡è®¾ä¸ºçœŸæ—¶æ‰€å¾—åˆ°çš„æ ·æœ¬è§‚å¯Ÿç»“æœæˆ–æ›´æç«¯ç»“æœå‡ºç°çš„æ¦‚ç‡ï¼Œå…¶På€¼å¾ˆå°ï¼Œè¯´æ˜åŸå‡è®¾å‘ç”Ÿçš„æ¦‚ç‡å¾ˆå°ï¼Œæ ¹æ®å°æ¦‚ç‡åŸç†ï¼Œ0.00439<0.05ï¼Œæœ‰ç†ç”±æ‹’ç»åŸå‡è®¾ã€‚På€¼è¶Šå°ï¼Œæ‹’ç»åŸå‡è®¾çš„ç†ç”±è¶Šå……åˆ†ï¼Œå°±æ˜¯è¯´æ ·æœ¬å‡å€¼ä¸º99.0ä¸æ€»ä½“å‡å€¼ä¹‹é—´çš„å·®å¼‚ä¸æ˜¯å¶ç„¶çš„ï¼Œå¾—å‡ºç»“è®ºè®¤ä¸º99.0çš„æ ·æœ¬å‡å€¼å®é™…ä¸Šå¼‚äºæ€»è®¡å‡å€¼ï¼Œä»è¯¥æ ·æœ¬ä¸­è§‚å¯Ÿåˆ°çš„ç›¸å…³æƒ…å†µä¸èƒ½ä»£è¡¨æ€»ä½“ä¸­çš„å®é™…ç°è±¡ã€‚

å¯¹äºä¸Šè¿°è¿‡ç¨‹ï¼Œå¯è½¬æ¢ä¸ºå‡è®¾æ£€éªŒçš„æ¨æ–­è¿‡ç¨‹ï¼Œæå‡ºä¸€ç§å‡è®¾å¹¶ç¡®ç«‹ä¸€ç§å‡†åˆ™ï¼Œç”¨äºå†³å®šä¿ç•™æˆ–æ‹’ç»å‡è®¾ã€‚å‡è®¾æ ·æœ¬å‡å€¼ä¸å¼‚äºæ€»ä½“å‡å€¼ä¸ºåŸå‡è®¾å³é›¶å‡è®¾ï¼ˆnull hypothesisï¼Œ$H_{0} $ï¼‰ï¼Œé›¶å‡è®¾ä¸€èˆ¬æŒ‡æ€»ä½“ä¸­çš„æ•ˆåº”ä¸å­˜åœ¨ï¼ˆæ€»ä½“å‡å€¼ä¸æ ·æœ¬å‡å€¼ä¸ä¼šä¸åŒï¼‰ï¼Œç¬¦å·è¡¨ç¤ºä¸ºï¼š$H_{0} : \mu = \overline{X} $ï¼Œå…¶ä¸­$ \mu$ä¸ºæ€»ä½“å‡å€¼ï¼Œ$\overline{X}$ä¸ºæ ·æœ¬å‡å€¼ã€‚å¦‚æœå‡è®¾æ ·æœ¬å‡å€¼å¼‚äºæ€»ä½“å‡å€¼ï¼Œåˆ™ä¸ºå¯¹ç«‹å‡è®¾ï¼ˆä¸€ç§æ›¿ä»£å‡è®¾ï¼‰ï¼Œç¬¦å·è¡¨ç¤ºä¸ºï¼š$H_{A} : \mu  \neq  \overline{X} $ã€‚æ ·æœ¬å‡å€¼è¶‹å‘äºç­‰åŒæ€»ä½“å‡å€¼ï¼Œä½†æ˜¯å› ä¸ºæ¯•ç«Ÿä¸æ˜¯æ€»ä½“ï¼Œä¹‹é—´æ€»ä¼šå­˜åœ¨å·®å¼‚ï¼Œå¼•èµ·è¿™ä¸ªå·®å¼‚çš„åŸå› å°±æ˜¯éšæœºæŠ½æ ·è¯¯å·®æˆ–å¶ç„¶å› ç´ ï¼Œè¿™æ­£æ˜¯å‡å€¼æŠ½æ ·åˆ†å¸ƒå‘ˆæ­£æ€æ€§çš„å†…åœ¨åŸå› ã€‚å…¶p-value<=0.05çš„æ¦‚ç‡å¯¹åº”ç€æ˜¾è‘—æ€§æ°´å¹³ï¼ˆÎ±ï¼Œalpha levelï¼‰ï¼Œä¾‹å¦‚æ ·æœ¬å‡å€¼99.0çš„æ¦‚ç‡ä¸º0.00439ï¼Œå°äºæ˜¾è‘—æ€§æ°´å¹³Î±ï¼Œæ‹’ç»é›¶å‡è®¾ï¼Œæ ·æœ¬å‡å€¼å¼‚äºæ€»ä½“å‡å€¼ï¼Œå…¶ç»“æœæ˜¯ç»Ÿè®¡æ˜¾è‘—çš„ï¼ˆæŒ‡åœ¨åŸå‡è®¾ä¸ºçœŸçš„æ¡ä»¶ä¸‹ï¼Œç”¨äºæ£€éªŒçš„æ ·æœ¬ç»Ÿè®¡é‡çš„å€¼è½åœ¨äº†æ‹’ç»åŸŸå†…ï¼Œåšå‡ºäº†æ‹’ç»åŸå‡è®¾çš„å†³å®šï¼‰ã€‚æ˜¾è‘—æ€§æ°´å¹³å¸¸ç”¨å€¼çš„é™¤äº†0.05ï¼Œè¿˜æœ‰0.01ã€‚

åœ¨ä¸Šè¿°è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œè®¡ç®—æœ‰æ¦‚ç‡å°äº0.025ï¼Œå’Œå¤§äº0.975çš„ä¸¤ç§æƒ…å†µï¼Œå¦‚æœåŒæ—¶åŒ…æ‹¬ä¸¤ç§æƒ…å†µï¼Œåˆ™ä¸ºåŒå°¾æ£€æµ‹ï¼Œä»…æœ‰ä¸€ç§æƒ…å†µï¼Œä½†æ˜¯æ¦‚ç‡éœ€è¦å°äº0.05æˆ–è€…å¤§äº0.95çš„æƒ…å†µä¸‹ä¸ºå•å°¾æ£€æµ‹ã€‚


```python
import matplotlib.pyplot as plt
df,loc,scale,sample_size=1999,100,12,1000

# ç»˜åˆ¶æ ·æœ¬å®¹é‡ä¸º1000çš„å•ä¸ªæ ·æœ¬çš„éšæœºå–å€¼åˆ†å¸ƒ
x=np.linspace(norm.ppf(0.001, loc=loc,scale=scale),norm.ppf(0.999, loc=loc,scale=scale), sample_size)
fig, axs=plt.subplots(1,3,figsize=(27,5))
axs[0].plot(x, norm.pdf(x,loc=loc,scale=scale),'r-', lw=2, alpha=0.8, label='nd-the distribution \n of individual sample values')
axs[0].legend(loc='upper left', frameon=False)

# ç»˜åˆ¶æ ·æœ¬å®¹é‡ä¸º1000ï¼Œæ ·æœ¬æ•°ä¸º2000çš„å‡å€¼æŠ½æ ·åˆ†å¸ƒ
samples=np.array([norm.rvs(loc=loc,scale=scale,size=sample_size).mean() for i in range(df+1)])
bins=30
sns.histplot(samples,bins=bins,ax=axs[1],label='sampling distribution of the mean',kde=True,stat="density",linewidth=0)
axs[1].legend(loc='upper left', frameon=False)

# è®¡ç®—2000ä¸ªæ ·æœ¬å‡å€¼æŠ½æ ·åˆ†å¸ƒçš„æ ‡å‡†å·®ï¼Œä½œä¸ºç»˜åˆ¶tåˆ†å¸ƒçš„æ ‡å‡†å·®ï¼Œå‡å€¼ä¿æŒä¿æŒä¿æŒä¸å˜ä¸º100ï¼Œè‡ªç”±åº¦ä¸º1999ï¼ˆå³æ ·æœ¬å®¹é‡ä¸º2000ï¼Œç­‰äºå‡å€¼æŠ½æ ·åˆ†å¸ƒçš„æ ·æœ¬æ•°é‡ï¼‰
samples_std=samples.std()
t_x=np.linspace(t.ppf(0.001, df=df,loc=loc,scale=samples_std),t.ppf(0.999, df=df,loc=loc,scale=samples_std), df+1)  # è·å–æœä»è‡ªç”±åº¦dfï¼Œæ¦‚ç‡ä½äº1%åˆ°99%çš„100ä¸ªå–å€¼
t_rv=t(df=df,loc=loc,scale=samples_std) # æŒ‡å®šå›ºå®šè‡ªç”±åº¦
axs[2].plot(t_x, t_rv.pdf(t_x), 'g-', lw=2, label='t-$mu$=%d,sigma=%d'%(loc,scale))

# æ˜¾è‘—æ€§æ°´å¹³ä¸º0.05æ—¶ï¼Œæ›²çº¿åŒºé—´ç»˜åˆ¶
pValue_5percent=t.ppf(0.025,df=df,loc=loc,scale=samples_std)
pValue_95percent=t.ppf(0.975,df=df,loc=loc,scale=samples_std)
axs[2].axvline(pValue_5percent, 0,0.3,c='gray',label='alpha level')
axs[2].axvline(pValue_95percent, 0,0.3,c='gray')
axs[2].annotate('reject null hypothesis,a=%.3f'%0.025,xy=(pValue_5percent,0.3),xytext=(pValue_5percent-0.1, 0.5),arrowprops=dict(facecolor='black', shrink=0.01),horizontalalignment='right',)
axs[2].annotate('reject null hypothesis,a=%.3f'%0.025,xy=(pValue_95percent,0.3),xytext=(pValue_95percent+0.07, 0.55),arrowprops=dict(facecolor='black', shrink=0.01),horizontalalignment='left',)
axs[2].legend(loc='upper left', frameon=False)

plt.show()

print("ç”¨.ppfæ‰¾åˆ°ç»™å®šæ¦‚ç‡å€¼ä¸º5%çš„æ•°å€¼ä¸ºï¼š",pValue_5percent)
print("ç”¨.ppfæ‰¾åˆ°ç»™å®šæ¦‚ç‡å€¼ä¸º95%çš„æ•°å€¼ä¸ºï¼š",pValue_95percent)
print("ç”¨.cdfè®¡ç®—å€¼å°äºæˆ–ç­‰äº99çš„æ¦‚ç‡ä¸ºï¼š",t.cdf(99.0,df=df,loc=loc,scale=samples_std))
```


<img src="./imgs/2_1_3/output_11_0.png" height='auto' width='auto' title="caDesign">   
    


    ç”¨.ppfæ‰¾åˆ°ç»™å®šæ¦‚ç‡å€¼ä¸º5%çš„æ•°å€¼ä¸ºï¼š 99.24538217329646
    ç”¨.ppfæ‰¾åˆ°ç»™å®šæ¦‚ç‡å€¼ä¸º95%çš„æ•°å€¼ä¸ºï¼š 100.75461782670354
    ç”¨.cdfè®¡ç®—å€¼å°äºæˆ–ç­‰äº99çš„æ¦‚ç‡ä¸ºï¼š 0.004710985065683475
    

#### 5ï¼‰æ•ˆåº”é‡
æ•ˆåº”é‡ï¼ˆeffect sizeï¼‰æ˜¯é‡åŒ–ç°è±¡å¼ºåº¦çš„æ•°å€¼ã€‚å…¶ç»å¯¹å€¼è¶Šå¤§è¡¨ç¤ºæ•ˆåº”è¶Šå¼ºï¼Œä¹Ÿå°±æ˜¯ç°è±¡è¶Šæ˜æ˜¾ã€‚å¯¹äºå‡å€¼æŠ½æ ·åˆ†å¸ƒï¼Œæ•ˆåº”é‡çš„è®¡ç®—å…¬å¼ä¸ºï¼š$d=\frac{ \overline{X} - \mu }{s}$ï¼Œå¼ä¸­$d$ä¸ºæ•ˆåº”é‡ï¼Œ$ \overline{X}$ä¸ºæ ·æœ¬å‡å€¼ï¼Œ$\mu$ä¸ºæ€»ä½“å‡å€¼ï¼Œ$s$ä¸ºæ ‡å‡†å·®çš„æ ·æœ¬ä¼°è®¡ã€‚æ•ˆåº”é‡æ‰€ä»£è¡¨çš„å°±æ˜¯ä»¥æ ‡å‡†å·®ä¸ºå•ä½æ‰€åº¦é‡çš„å·®å¼‚ï¼Œè¿™ä¸ªä¸æ ‡å‡†è®¡åˆ†ï¼ˆz-scoreï¼‰éå¸¸ç›¸ä¼¼ï¼Œæ ‡å‡†è®¡åˆ†æ˜¯ä»¥æ ‡å‡†å·®ä¸ºå•ä½ï¼Œä»æ„Ÿå…´è¶£çš„ç‚¹åˆ°å‡å€¼ä¹‹é—´æœ‰å¤šå°‘ä¸ªæ ‡å‡†å·®ã€‚å…³äºæ•ˆåº”é‡æ˜¯å¦æœ‰æ„ä¹‰æ—¶ï¼Œæ‰€å»ºè®®çš„æ•ˆåº”é‡å€¼çš„åŒºé—´ä¹Ÿæ‰€æœ‰å·®å¼‚ï¼Œå…³é”®æ˜¯æ£€éªŒä»€ä¹ˆä»¥åŠæ‰€æŒè§‚ç‚¹ï¼Œä¸€èˆ¬è€Œè¨€æ•ˆåº”é‡å°äº0.20ç®—å°ï¼Œåœ¨0.25~0.75ä¹‹é—´ç®—ä¸­ç­‰ï¼Œè¶…è¿‡0.80ç®—å¤§ã€‚å¯¹äºæ ·æœ¬å‡å€¼99çš„æ•ˆåº”é‡è®¡ç®—ç»“æœä¸º-2.583ï¼Œå…¶ç»å¯¹å€¼å¤§äº0.8ï¼Œè¡¨æ˜æ ·æœ¬å‡å€¼99åˆ°æ€»ä½“å‡å€¼100ä¹‹é—´æ‰€å·®çš„100-99=1çš„å·®å¼‚ï¼ŒæŒ‰ç…§æ ‡å‡†å·®ä¸ºå•ä½ï¼Œæ•ˆåº”é‡æ˜¾è‘—ï¼Œå³æ ·æœ¬å‡å€¼99è¿œç¦»æ€»ä½“å‡å€¼100ã€‚


```python
print("æ ·æœ¬å‡å€¼99çš„æ•ˆåº”é‡ï¼š",(99-100)/samples_std)
```

    æ ·æœ¬å‡å€¼99çš„æ•ˆåº”é‡ï¼š -2.5988670698883993
    

#### 6ï¼‰ç½®ä¿¡åŒºé—´
ä¸€ä¸ªæ¦‚ç‡æ ·æœ¬çš„ç½®ä¿¡åŒºé—´ï¼ˆConfidence intervalï¼ŒCIï¼‰ï¼Œæ˜¯å¯¹äº§ç”Ÿè¿™ä¸ªæ ·æœ¬çš„æ€»ä½“çš„å‚æ•°åˆ†å¸ƒï¼ˆParametric Distributionï¼‰ä¸­çš„æŸä¸€ä¸ªä½ç½®å‚æ•°å€¼ï¼Œä»¥åŒºé—´çš„å½¢å¼ç»™å‡ºä¼°è®¡ã€‚å¯¹äºç°å®ä¸­å‡å€¼æŠ½æ ·åˆ†å¸ƒï¼Œå®é™…ä¸Šæ€»ä½“çš„å‡å€¼ï¼ˆæ€»ä½“å‚æ•°çš„å®é™…å€¼ï¼‰å¹¶ä¸çŸ¥é“ï¼Œæˆ‘ä»¬æ‰€æ‹¥æœ‰çš„åªæ˜¯æ ·æœ¬æ•°æ®ï¼Œè€Œé€šè¿‡æ ·æœ¬æ•°æ®æ˜¯å¯ä»¥ä¼°è®¡æ€»ä½“å‡å€¼ï¼Œç»™å‡ºæ€»ä½“å‡å€¼åˆ†å¸ƒçš„åŒºé—´ï¼Œè¿™ä¸ªåŒºé—´å³ä¸ºç½®ä¿¡åŒºé—´ã€‚è®¡ç®—å…¬å¼ä¸ºï¼š$C I_{95}= \overline{X}   \pm ( t_{95} )( s_{ \overline{X} })$ å’Œ$C I_{99}= \overline{X}   \pm ( t_{99} )(s_{ \overline{X} } )$ï¼Œå¼ä¸­$C I_{95}$ä¸º95%ç½®ä¿¡åŒºé—´ï¼› $C I_{99}$ä¸º99%ç½®ä¿¡åŒºé—´ï¼› $\overline{X}$ä¸ºæ ·æœ¬å‡å€¼ï¼› $ s_{ \overline{X} }$ï¼›ä¸ºæ ‡å‡†è¯¯ï¼› $t_{95} $ä¸ºç»™å®šè‡ªç”±åº¦æ¡ä»¶ä¸‹ï¼Œ$a$æ°´å¹³ä¸º0.05åŒå°¾æ£€éªŒæ‰€å¯¹åº”çš„tå€¼ï¼› $t_{99} $ä¸ºç»™å®šè‡ªç”±åº¦æ¡ä»¶ä¸‹ï¼Œ$a$æ°´å¹³ä¸º0.01åŒå°¾æ£€éªŒæ‰€å¯¹åº”çš„tå€¼ã€‚

å¯¹äºç½®ä¿¡åŒºé—´çš„è®¡ç®—å¯ä»¥ç›´æ¥ä½¿ç”¨`SciPy`åº“ã€‚


```python
print("0.05_ç½®ä¿¡åŒºé—´ï¼š",stats.t.interval(0.95, len(samples)-1, loc=np.mean(samples), scale=stats.sem(samples)))
print("0.01_ç½®ä¿¡åŒºé—´ï¼š",stats.t.interval(0.99, len(samples)-1, loc=np.mean(samples), scale=stats.sem(samples)))
```

    0.05_ç½®ä¿¡åŒºé—´ï¼š (99.98972207782829, 100.02347805302809)
    0.01_ç½®ä¿¡åŒºé—´ï¼š (99.98441087421692, 100.02878925663946)
    

### 2.1.3.2 ç›¸å…³æ€§

å¦‚æœè¦åˆ¤æ–­ä¸¤ä¸ªå˜é‡ä¹‹é—´æ˜¯å¦ç›¸äº’è”ç³»ï¼Œåˆ™éœ€è¦è®¡ç®—ç›¸å…³ç³»æ•°ã€‚åœ¨å˜é‡ä¹‹é—´ç›¸å…³æ€§åˆ†ææ—¶ï¼Œæ¶‰åŠåˆ°ä¸‰ç§æƒ…å†µï¼ŒåŒ…æ‹¬æ•°å€¼æ•°æ®ä¸æ•°å€¼æ•°æ®ã€æ•°å€¼æ•°æ®ä¸åˆ†ç±»æ•°æ®ï¼ŒåŠåˆ†ç±»æ•°æ®ä¸åˆ†ç±»æ•°æ®ã€‚å› æ­¤ä¸åŒçš„å˜é‡ç±»å‹ä¹‹é—´çš„ç›¸å…³æ€§è®¡ç®—æŒ‡æ ‡æœ‰æ‰€å·®å¼‚ï¼š

| æ•°æ®ç±»å‹  | æŒ‡æ ‡  | å€¼çš„èŒƒå›´  | è®¡ç®—å…¬å¼  | è¯´æ˜  |
|---|---|---|---|---|
| æ•°å€¼æ•°æ®å’Œæ•°å€¼æ•°æ®  | ç›¸å…³ç³»æ•°  |  -1~1 |$ r=\frac{ S_{xy} }{ \sqrt{ S_{xx}\cdot S_{yy} } } = \frac{ \sum_{i=1}^n ( x_{i}-  \overline{x}   )( y_{i}- \overline{y}  ) }{  \sqrt{ \sum_{i=1}^n ( x_{i} -\overline{x})^{2} } \cdot \sum_{i=1}^n ( y_{i} -\overline{y})^{2} }  \in [-1,1] $ |  å¼ä¸­$S_{xx}$å«åš$x$çš„æ–¹å·®ï¼ˆVarianceï¼‰ï¼Œ$S_{yy}$ å«åš$y$çš„æ–¹å·®ï¼Œ$S_{xy}$å«åš$x$å’Œ$y$çš„åæ–¹å·®ï¼ˆCovarianceï¼‰|
| æ•°å€¼æ•°æ®å’Œåˆ†ç±»æ•°æ®  | ç›¸å…³æ¯”  | 0~1  |  $WSS= \sum_{k=1}^K S_{ x^{k}  x^{i} } = \sum_{k=1}^K  \sum_{i=1}^{ n_{i} }  ( x_i^k - \overline{ x^{k} }  ) ^{2}  $ $BSS= \sum_{k=1}^K n_{k}  ( \overline{ x^{k} } - \overline{x} )^{2}  $ $cr=\frac{BSS}{BSS+WSS} $ | è®¾å…±æœ‰nä¸ªæ•°å€¼æ•°æ®ï¼Œå®ƒä»¬è¢«åˆ†æˆäº†Kä¸ªç±»åˆ«ï¼Œ$x_1^1,x_2^1, \cdots, x_{ n_{1} } ^1;x_1^2,x_2^2, \cdots, x_{ n_{2} } ^2;\cdots;x_1^K,x_2^K, \cdots, x_{ n_{K} } ^K$,å¼ä¸­$n_{K} $ä»£è¡¨ç¬¬$K$ä¸ªç±»åˆ«çš„æ•°å€¼çš„ä¸ªæ•°ï¼Œè®°$ \overline{ x^{k}}$ä¸ºç¬¬Kä¸ªç±»åˆ«æ•°å€¼çš„å‡å€¼ï¼Œ$\overline{x}$ä¸ºæ‰€æœ‰æ•°æ®çš„å‡å€¼ã€‚WSSï¼ˆwithin sum of squaresï¼‰ä¸ºç»„å†…å˜å¼‚ ï¼ŒBSSï¼ˆbetween sum of squaresï¼‰ä¸ºç»„é—´å˜å¼‚ |
| åˆ†ç±»æ•°æ®å’Œåˆ†ç±»æ•°æ®  | å…‹è±å§†ç›¸å…³ç³»æ•°  | 0~1  | $ \chi ^{2} = \sum_{i,j}^{}  \frac{ ( n_{ij}- \frac{ n_{i}  n_{j} }{n}  )^{2} }{ \frac{ n_{i}  n_{j} }{n} } $ $V= \sqrt{ \frac{  \chi ^{2}/n }{min(k-1,r-1)} } $ | è®¾æœ‰ä¸¤ä¸ªç±»åˆ«å˜é‡Aå’ŒBï¼Œè§‚æµ‹æ ·æœ¬æ€»æ•°ä¸º$n$ï¼Œå¯¹äº$i=1,\cdots, r;j=1,\cdots,k $ï¼Œ $n_{ij}$ ä¸º$( A_{i}, B_{j}  )$çš„è§‚æµ‹æ¬¡æ•°ï¼ˆé¢‘æ•°ï¼‰ï¼Œ$k$ä¸ºè§‚å¯Ÿæ¬¡æ•°è¡¨åˆ—ï¼Œ$r$ä¸ºå…¶è¡Œã€‚$ \frac{ n_{i}  n_{j} }{n}$ä¸ºè®¡ç®—æœŸæœ›æ¬¡æ•°|

å¯¹äºæ•°å€¼æ•°æ®å’Œæ•°å€¼æ•°æ®ä¹‹é—´çš„ç›¸å…³æ€§åˆ†æï¼Œä½¿ç”¨ç›¸å…³ç³»æ•°è®¡ç®—ï¼ˆé€šå¸¸ä¸ºPearson's rï¼Œå³çš®å°”æ£®ç›¸å…³ç³»æ•° rï¼Œä¸ºçº¿æ€§ç›¸å…³ï¼‰ã€‚å…ˆå»ºç«‹ç®€å•æ•°æ®é›†ï¼Œæ•°æ®æ¥æºäºã€Šæ¼«ç”»ç»Ÿè®¡å­¦ã€‹è¯¢é—®10å20å¤šå²å¥³æ€§çš„åŒ–å¦†å“è´¹å’Œç½®è£…è´¹<sup>[2]</sup>ã€‚å¾…åˆ†æçš„ä¸¤ä¸ªå˜é‡ä¸ºxå’Œyå€¼ï¼Œæ‰“å°æ•£ç‚¹å›¾è§‚å¯Ÿç‚¹çš„åˆ†å¸ƒæ˜¯å¦å­˜åœ¨è§„å¾‹ï¼Œå¯ä»¥æ¯”è¾ƒæ˜æ˜¾çš„è§‚å¯Ÿåˆ°ç‚¹çš„åˆ†å¸ƒä¼¼ä¹æ²¿ä¸€æ¡éšè—çš„å€¾æ–œç›´çº¿åˆ†å¸ƒï¼Œå¯ä»¥åˆæ­¥åˆ¤æ–­åŒ–å¦†å“è´¹å’Œç½®è£…è´¹ä¹‹é—´å­˜åœ¨å…³è”ã€‚

> çš®å°”æ£®ç›¸å…³ç³»æ•°ï¼Œåˆç§°ç§¯å·®ç›¸å…³ç³»æ•°ã€ç§¯çŸ©ç›¸å…³ç³»æ•°ï¼ˆPearson product-moment correlation coefficientï¼ŒPPMCCæˆ–PCCsï¼‰


```python
import pandas as pd

dressUp_cost={'name':["miss_A","miss_B","miss_C","miss_D","miss_E","miss_F","miss_G","miss_H","miss_I","miss_J"],
              "cosmetics_fee":[3000,5000,12000,2000,7000,15000,5000,6000,8000,10000],
             "clothes_fee":[7000,8000,25000,5000,12000,30000,10000,15000,20000,18000]
             }
dressUp_cost_df=pd.DataFrame.from_dict(dressUp_cost)
dressUp_cost_df.plot.scatter(x='cosmetics_fee',y='clothes_fee',c='DarkBlue')
plt.show()
```


<img src="./imgs/2_1_3/output_18_0.png" height='auto' width='auto' title="caDesign">    
   


ä½¿ç”¨ä¸Šè¿°å…¬å¼è®¡ç®—ç›¸å…³ç³»æ•°ã€‚

> äººå·¥è®¡ç®—çš„è¿‡ç¨‹æœ‰åŠ©äºç†è§£æ¦‚å¿µåŠå…¬å¼ã€‚


```python
import math

dressUp_cost_df["xSx_mean"]=dressUp_cost_df.cosmetics_fee.apply(lambda row: row-dressUp_cost_df.cosmetics_fee.mean()) 
dressUp_cost_df["ySy_mean"]=dressUp_cost_df.clothes_fee.apply(lambda row: row-dressUp_cost_df.clothes_fee.mean())
dressUp_cost_df["square_xSx_mean"]=dressUp_cost_df.xSx_mean.apply(lambda row: math.pow(row,2))
dressUp_cost_df["square_ySy_mean"]=dressUp_cost_df.ySy_mean.apply(lambda row: math.pow(row,2))
dressUp_cost_df["xSx_meanMySy_mean"]=dressUp_cost_df.xSx_mean*dressUp_cost_df.ySy_mean
r=dressUp_cost_df.xSx_meanMySy_mean.sum()/math.sqrt(dressUp_cost_df.square_xSx_mean.sum()*dressUp_cost_df.square_ySy_mean.sum())
print("Pearson's r:",r)

dressUp_cost_df
```

    Pearson's r: 0.968019612860768
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>cosmetics_fee</th>
      <th>clothes_fee</th>
      <th>xSx_mean</th>
      <th>ySy_mean</th>
      <th>square_xSx_mean</th>
      <th>square_ySy_mean</th>
      <th>xSx_meanMySy_mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>miss_A</td>
      <td>3000</td>
      <td>7000</td>
      <td>-4300.0</td>
      <td>-8000.0</td>
      <td>18490000.0</td>
      <td>64000000.0</td>
      <td>34400000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>miss_B</td>
      <td>5000</td>
      <td>8000</td>
      <td>-2300.0</td>
      <td>-7000.0</td>
      <td>5290000.0</td>
      <td>49000000.0</td>
      <td>16100000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>miss_C</td>
      <td>12000</td>
      <td>25000</td>
      <td>4700.0</td>
      <td>10000.0</td>
      <td>22090000.0</td>
      <td>100000000.0</td>
      <td>47000000.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>miss_D</td>
      <td>2000</td>
      <td>5000</td>
      <td>-5300.0</td>
      <td>-10000.0</td>
      <td>28090000.0</td>
      <td>100000000.0</td>
      <td>53000000.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>miss_E</td>
      <td>7000</td>
      <td>12000</td>
      <td>-300.0</td>
      <td>-3000.0</td>
      <td>90000.0</td>
      <td>9000000.0</td>
      <td>900000.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>miss_F</td>
      <td>15000</td>
      <td>30000</td>
      <td>7700.0</td>
      <td>15000.0</td>
      <td>59290000.0</td>
      <td>225000000.0</td>
      <td>115500000.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>miss_G</td>
      <td>5000</td>
      <td>10000</td>
      <td>-2300.0</td>
      <td>-5000.0</td>
      <td>5290000.0</td>
      <td>25000000.0</td>
      <td>11500000.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>miss_H</td>
      <td>6000</td>
      <td>15000</td>
      <td>-1300.0</td>
      <td>0.0</td>
      <td>1690000.0</td>
      <td>0.0</td>
      <td>-0.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>miss_I</td>
      <td>8000</td>
      <td>20000</td>
      <td>700.0</td>
      <td>5000.0</td>
      <td>490000.0</td>
      <td>25000000.0</td>
      <td>3500000.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>miss_J</td>
      <td>10000</td>
      <td>18000</td>
      <td>2700.0</td>
      <td>3000.0</td>
      <td>7290000.0</td>
      <td>9000000.0</td>
      <td>8100000.0</td>
    </tr>
  </tbody>
</table>
</div>



ä½¿ç”¨`SciPy`åº“ç›´æ¥è®¡ç®—ï¼Œå…¶ç»“æœä¿æŒä¸€è‡´ã€‚


```python
from scipy import stats

r_=stats.pearsonr(dressUp_cost_df.cosmetics_fee,dressUp_cost_df.clothes_fee)
print(
    "pearson's r:",r_[0],"\n",
    "p_value:",r_[1]
     )
```

    pearson's r: 0.968019612860768 
     p_value: 4.402991448166131e-06
    

ç›¸å…³ç³»æ•°çš„å¼ºå¼±å¹¶æ²¡æœ‰ä¸¥æ ¼çš„è§„å®šï¼Œé€šå¸¸éœ€è¦æ ¹æ®å…·ä½“çš„åº”ç”¨èƒŒæ™¯å’Œç›®çš„ç¡®å®šï¼Œä¾‹å¦‚å¤æ‚å¤šå˜å› ç´ å½±å“çš„å˜é‡ï¼Œ0.9çš„å€¼åˆ™æ˜¯ç›¸å½“é«˜çš„ã€‚å¯¹äºç›¸å…³ç³»æ•°å€¼çš„æ„ä¹‰ä¸åŒçš„æ–‡çŒ®ç»™å‡ºçš„å‚è€ƒæ„ä¹‰ä¹Ÿæœ‰æ‰€å·®åˆ«ï¼Œè¿™é‡Œç»™å‡ºã€Šæ¼«ç”»ç»Ÿè®¡å­¦ã€‹é‡Œçš„åˆ’åˆ†ï¼š

| ç›¸å…³ç³»æ•°çš„ç»å¯¹å€¼  | è‹¥ç»†åˆ†  | è‹¥å¤§ä½“ä¸Šåˆ’åˆ†  |  
|---|---|---|
| 1.0~0.9  |  éå¸¸å¼º |  ç›¸å…³ |   
| 0.9~0.7  | æœ‰ç‚¹å¼º  |  ç›¸å…³ |   
|0.7~0.5   | æœ‰ç‚¹å¼±  |  ç›¸å…³ |   
| æœªæ»¡0.5  |  éå¸¸å¼± | ä¸ç›¸å…³  |   


åŠWikipediaç»™å‡ºçš„å‚è€ƒï¼š

| ç›¸å…³æ€§  | è´Ÿ  | æ­£  |  
|---|---|---|
| æ—   | âˆ’0.09 to 0.0 | 0.0 to 0.09  |   
| å¼±  | âˆ’0.3 to âˆ’0.1  | 0.1 to 0.3 |   
|ä¸­   |âˆ’0.5 to âˆ’0.3  | 0.3 to 0.5 |   
| å¼º  | âˆ’1.0 to âˆ’0.5 |0.5 to 1.0   | 

è‹¥ç›¸å…³ç³»æ•°æ¥è¿‘$ \pm1 $ï¼Œåˆ™ç›¸å…³æ€§è¶Šå¼ºï¼›å¦‚æœæ¥è¿‘0ï¼Œåˆ™ç›¸å…³æ€§è¶Šå¼±ã€‚å¦‚æœä¸ºæ­£ï¼Œåˆ™ä¸ºæ­£ç›¸å…³ï¼›å¦‚æœä¸ºè´Ÿï¼Œåˆ™ä¸ºè´Ÿç›¸å…³ã€‚

é€šè¿‡è®¡ç®—ç›¸å…³ç³»æ•°ï¼Œè·å¾—ç»“æœr=0.968ï¼Œè¯´æ˜æŠ½æ ·çš„10å20å¤šå²å¥³æ€§åœ¨åŒ–å¦†å“è´¹å’Œç½®è£…è´¹è¿™ä¸¤ä¸ªå˜é‡é—´å­˜åœ¨å¼ºç›¸å…³æ€§ï¼Œé‚£ä¹ˆè¯¥å€¼æ˜¯å¦ä»£è¡¨å…¶æŠ½æ ·çš„æ€»ä½“ï¼ˆæ‰€æœ‰å¥³æ€§ï¼‰ä¸­ä¸¤ä¸ªå˜é‡ï¼ˆåŒ–å¦†å“è´¹å’Œç½®è£…è´¹ï¼‰é—´ä¹Ÿå­˜åœ¨éå¸¸å¼ºçš„ç›¸å…³å…³ç³»ï¼Ÿä¸ºäº†ç¡®è®¤è¿™ä¸ªç°è±¡ï¼Œéœ€è¦æ£€éªŒç›¸å…³ç³»æ•°æ˜¯å¦ç»Ÿè®¡æ˜¾è‘—ã€‚æå‡ºé›¶å‡è®¾ï¼Œä»£è¡¨æ€»ä½“ä¸‹ä¸¤ä¸ªå˜é‡ï¼ˆåŒ–å¦†å“è´¹å’Œç½®è£…è´¹ï¼‰ä¹‹é—´å®Œå…¨æ— å…³ï¼Œå³æ€»ä½“çš„ç›¸å…³ç³»æ•°ä¸º0ã€‚é€šå¸¸ç”¨tåˆ†å¸ƒæ¥æ£€éªŒç›¸å…³ç³»æ•°æ˜¯å¦ç»Ÿè®¡æ˜¾è‘—ï¼Œè¿›è¡Œtæ£€éªŒã€‚å…¶tå€¼çš„è®¡ç®—å…¬å¼ä¸ºï¼š$t=r \sqrt{ \frac{N-2}{1- r^{2} } } $ï¼Œå¼ä¸­è‡ªç”±åº¦ä¸º$N-2$ï¼Œå³æ ·æœ¬å¯¹è±¡æ•°å‡å»2ï¼Œå³N-2=10-2=8ã€‚ä½¿ç”¨tåˆ†å¸ƒçš„ç´¯è®¡åˆ†å¸ƒå‡½æ•°`t.cdf()`æˆ–è€…`t.sf()`è®¡ç®—På€¼ï¼Œå› ä¸ºåŒå°¾æ£€æŸ¥ï¼Œå› æ­¤å†ä¹˜ä»¥2ï¼Œå…¶è®¡ç®—ç»“æœä¸`stats.pearsonr()`è®¡ç®—ç›¸å…³ç³»æ•°æ—¶ç»™å‡ºçš„På€¼ä¿æŒä¸€è‡´ã€‚å› ä¸ºp_value=4.402991448104743e-06<0.05ï¼Œå› æ­¤æ‹’ç»åŸå‡è®¾ï¼Œå³æ‹’ç»æ€»ä½“ä¸‹ä¸¤ä¸ªå˜é‡ï¼ˆåŒ–å¦†å“è´¹å’Œç½®è£…è´¹ï¼‰ä¹‹é—´å®Œå…¨æ— å…³ï¼Œå°±æ˜¯è¯´æ€»ä½“ä¸‹ä¸¤ä¸ªå˜é‡æ˜¯ç›¸å…³çš„ã€‚å› æ­¤æ‰€è®¡ç®—çš„ç›¸å…³ç³»æ•°å€¼ä¸º0.968è¯´æ˜äº†æ€»ä½“æ‰€æœ‰å¥³æ€§åœ¨åŒ–å¦†å“è´¹å’Œç½®è£…è´¹çš„æ¶ˆè´¹ä¸Šæ˜¯å¼ºå…³è”çš„ï¼Œå¦‚æœä¸€ä¸ªå¥³æ€§èŠ±è´¹è¾ƒå¤šçš„é’±åœ¨åŒ–å¦†å“è´¹ä¸Šï¼Œé‚£ä¹ˆå¥¹èŠ±è´¹åœ¨ç½®è£…è´¹çš„é’±ä¹Ÿç›¸å¯¹è¾ƒå¤šï¼Œåä¹‹äº¦ç„¶ã€‚


```python
t_value=r*math.sqrt((10-2)/(1-math.pow(r,2)))
print("p-value_cdf:",(1-stats.t.cdf(t_value,10-2))*2)
print("p-value_sf:",stats.t.sf(t_value,10-2)*2)
```

    p-value_cdf: 4.402991448104743e-06
    p-value_sf: 4.402991448166121e-06
    

### 2.1.3.3 å¡æ–¹åˆ†å¸ƒä¸ç‹¬ç«‹æ€§æ£€éªŒ

#### 1ï¼‰ å¡æ–¹åˆ†å¸ƒï¼ˆChi-Square Distributionï¼ŒÏ‡Â²-distributionï¼‰<sup>[1][2][3]</sup>
è‹¥kä¸ªéšæœºå˜é‡$Z_{1} , \ldots  \ldots ,Z_{k}$ï¼Œæ˜¯ç›¸äº’ç‹¬ç«‹ï¼Œç¬¦åˆæ ‡å‡†æ­£æ€åˆ†å¸ƒçš„éšæœºå˜é‡ï¼ˆæ•°å­¦æœŸæœ›ä¸º0ï¼Œæ–¹å·®ä¸º1ï¼‰ï¼Œåˆ™éšæœºå˜é‡$Z$çš„å¹³æ–¹å’Œ$X= \sum_{i=1}^k   x_{i} ^{2}$è¢«ç§°ä¸ºæœä»è‡ªç”±åº¦ä¸º$k$çš„å¡æ–¹åˆ†å¸ƒï¼Œè®°ä½œ$X \sim  x^{2} (k)$æˆ–$X \sim   x_{k} ^{2} $ã€‚å¡æ–¹åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆå³è®¡ç®—å¡æ–¹åˆ†å¸ƒæ›²çº¿çš„å…¬å¼ï¼‰ä¸ºï¼š$f_{k} (x)= \frac{  \frac{1}{2} ^{ \frac{k}{2} } }{ \Gamma ( \frac{k}{2} )}  x^{ \frac{k}{2}-1 } e^{ \frac{-x}{2} }  $ï¼Œå¼ä¸­$x \geq 0$ï¼Œå½“$x  \leq 0$æ—¶$f_{k} (x)=0$ã€‚$\Gamma $ä»£è¡¨Gammaå‡½æ•°ã€‚åœ¨Pythonä¸­ç»˜åˆ¶å¡æ–¹åˆ†å¸ƒï¼Œä»æ—§ä¸æ­£æ€åˆ†å¸ƒã€tåˆ†å¸ƒä¸€æ ·ï¼Œç›´æ¥ç”±`SciPy`åº“å®Œæˆã€‚

å› ä¸ºå¡æ–¹åˆ†å¸ƒè¡¨è¿°çš„æ˜¯å¤šä¸ªäº‹ä»¶ï¼ˆéšæœºå˜é‡ï¼‰çš„æœºç‡ï¼Œæ¯ä¸ªäº‹ä»¶ç¬¦åˆæ ‡å‡†æ­£æ€åˆ†å¸ƒï¼Œè€Œæ ‡å‡†æ­£æ€åˆ†å¸ƒè¡¨ä¸ºè®°å½•å¯¹åº”æ¨ªè½´åˆ»åº¦çš„æœºç‡è¡¨ï¼Œå¡æ–¹åˆ†å¸ƒè¡¨åˆ™æ˜¯è®°å½•å¯¹åº”å‡ ç‡çš„æ¨ªè½´åˆ»åº¦è¡¨ã€‚

å¯¹äºå¡æ–¹åˆ†å¸ƒçš„ç†è§£ï¼Œå¯ä»¥ç»“åˆæ¯”è¾ƒå‡å€¼æŠ½æ ·åˆ†å¸ƒï¼ŒäºŒè€…å…·æœ‰ç±»ä¼¼çš„é€»è¾‘ã€‚å¯ä»¥è¡¨è¿°ä¸ºä»åŒä¸€æ€»ä½“ä¸­æŠ½å–ç›¸åŒå®¹é‡æ ·æœ¬å¹³æ–¹å’Œçš„åˆ†å¸ƒï¼Œå‡è®¾ä»æœä»å¹³å‡å€¼ä¸º30ï¼Œæ ‡å‡†å·®ä¸º5çš„æ­£æ€åˆ†å¸ƒä¸­ï¼Œéšæœºæå–2000ä¸ªæ ·æœ¬ï¼ˆäº‹ä»¶ï¼Œæˆ–éšæœºå˜é‡ï¼Œå³$Z_{k}$ï¼‰ï¼Œå„ä¸ªæ ·æœ¬çš„å®¹é‡ä¸º1000ï¼Œè®¡ç®—æ¯ä¸€æ ·æœ¬çš„å¹³æ–¹å’Œï¼Œè§‚å¯Ÿè¿™2000ä¸ªæ ·æœ¬çš„å¡æ–¹åˆ†å¸ƒæƒ…å†µã€‚ä»ä¸‹è¿°å®éªŒæ‰“å°ç»“æœæ¥çœ‹ï¼Œ$x^{2}$è¶‹è¿‘æœä»è‡ªç”±åº¦ä¸º$(2000-1)$çš„$x^{2}$åˆ†å¸ƒã€‚å³å¯ä»¥é€šè¿‡ä¸€ä¸ªæ£€éªŒç»Ÿè®¡é‡ï¼ˆå¹³æ–¹å’Œï¼‰æ¥æ¯”è¾ƒæœŸæœ›ç»“æœå’Œå®é™…ç»“æœä¹‹é—´çš„å·®åˆ«ï¼Œç„¶åå¾—å‡ºè§‚å¯Ÿé¢‘æ•°æå€¼çš„å‘ç”Ÿæ¦‚ç‡ã€‚å› æ­¤ä»¥ç‰¹å®šæ¦‚ç‡åˆ†å¸ƒä¸ºæŸç§æƒ…å†µå»ºæ¨¡æ—¶ï¼Œäº‹ä»¶é•¿æœŸç»“æœè¾ƒä¸ºç¨³å®šï¼Œèƒ½å¤Ÿæ¸…æ™°è¿›è¡ŒæŠŠæ¡ã€‚ä½†æ˜¯å¦‚æœæœŸæœ›ä¸äº‹å®å­˜åœ¨å·®å¼‚æ—¶ï¼Œåˆ™å¯ä»¥åº”ç”¨å¡æ–¹åˆ†å¸ƒåˆ¤æ–­åå·®æ˜¯æ­£å¸¸çš„å°å¹…åº¦æ³¢åŠ¨è¿˜æ˜¯å»ºæ¨¡ä¸Šçš„é”™è¯¯ã€‚ä¸€æ˜¯ï¼Œå¯ä»¥æ£€éªŒä¸€ç»„ç»™å®šæ•°æ®ä¸æŒ‡å®šåˆ†å¸ƒçš„å»åˆç¨‹åº¦ï¼›äºŒæ˜¯ï¼Œå¯ä»¥æ£€éªŒä¸¤ä¸ªå˜é‡çš„ç‹¬ç«‹æ€§ï¼Œå³å˜é‡ä¹‹é—´æ˜¯å¦å­˜åœ¨æŸç§å…³ç³»ã€‚

* $\Gamma $å‡½æ•°

åœ¨æ•°å­¦ä¸­ï¼Œ$\Gamma $å‡½æ•°ï¼Œä¹Ÿç§°ä¸ºä¼½é©¬å‡½æ•°ï¼ˆGammaå‡½æ•°ï¼‰ï¼Œæ˜¯é˜¶ä¹˜å‡½æ•°åœ¨å®æ•°ä¸å¤æ•°åŸŸä¸Šçš„æ‰©å±•ã€‚å¦‚æœ$n$ä¸ºæ­£æ•´æ•°ï¼Œåˆ™ï¼š$\Gamma (n)=(n-1)!$ï¼Œå³æ­£æ•´æ•°çš„é˜¶ä¹˜ï¼›å¯¹äºå®æ•°éƒ¨åˆ†ä¸ºæ­£çš„å¤æ•°$z$ï¼Œä¼½é©¬å‡½æ•°å®šä¹‰ä¸ºï¼š$\Gamma (z)= \int_0^ \infty   t^{z-1} e^{-t} dt$ã€‚å‘ç°$\Gamma $å‡½æ•°çš„èµ·å› æ˜¯æ•°åˆ—æ’å€¼é—®é¢˜ï¼Œå³æ‰¾åˆ°ä¸€ä¸ªå…‰æ»‘çš„æ›²çº¿è¿æ¥é‚£äº›ç”±$y=(x-1)!$æ‰€ç»™å®šçš„ç‚¹$(x,y)$ï¼Œå¹¶è¦æ±‚$x$ä¸ºæ­£æ•´æ•°ã€‚ä½†æ˜¯å¦‚æœ$x$ç”±æ­£æ•´æ•°æ‹“å±•åˆ°å®æ•°ï¼Œå³å¯ä»¥è®¡ç®—$2!,3!, \ldots ,$ï¼Œé‚£ä¹ˆæ˜¯å¦å¯ä»¥è®¡ç®—$2.5ï¼$ï¼Œå¹¶ç»˜åˆ¶$(n,n!)$çš„å¹³æ»‘æ›²çº¿ï¼Ÿè€Œ$\Gamma $å‡½æ•°æ­£æ˜¯å€Ÿç”±å¾®ç§¯åˆ†çš„ç§¯åˆ†ä¸æé™è¡¨è¾¾é˜¶ä¹˜ã€‚

ä¼½é©¬ï¼ˆGammaï¼‰åˆ†å¸ƒï¼Œå‡è®¾$X_{1} ,X_{2}, \ldots ,X_{n}$ä¸ºè¿ç»­å‘ç”Ÿäº‹ä»¶çš„ç­‰å€™æ—¶é—´ï¼Œä¸”è¿™$n$æ¬¡ç­‰ä¾¯æ—¶é—´ä¸ºç‹¬ç«‹çš„ï¼Œé‚£ä¹ˆè¿™$n$æ­¤ç­‰å€™æ—¶é—´ä¹‹å’Œ$Y(Y=X_{1} ,X_{2}, \ldots ,X_{n})$æœä»ä¼½é©¬åˆ†å¸ƒï¼Œå³$Y \sim Gamma( \alpha , \beta )$ï¼Œå¼ä¸­$\alpha =n, \beta = \gamma $ï¼Œ$\alpha$æ˜¯ä¼½é©¬åˆ†å¸ƒä¸­çš„æ¯æ•°ï¼Œç§°ä¸ºå½¢çŠ¶å‚æ•°ï¼Œ$\beta$ä¸ºå°ºåº¦å‚æ•°ã€‚$\gamma$æ˜¯è¿ç»­å‘ç”Ÿäº‹ä»¶çš„å¹³å‡å‘ç”Ÿé¢‘ç‡ã€‚æŒ‡æ•°åˆ†å¸ƒæ˜¯ä¼½é©¬åˆ†å¸ƒ$\alpha=1$çš„ç‰¹æ®Šæƒ…å†µã€‚ 

ä»¤$X \sim  \Gamma ( \alpha , \beta )$ï¼Œä¸”$\lambda = \beta $ï¼ˆå³$X \sim  \Gamma ( \alpha ,  \gamma  )$ï¼‰ï¼Œåˆ™ä¼½é©¬åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºï¼š$f(x)= \frac{ x^{a-1}  \gamma ^{a}   e^{- \gamma x} }{ \Gamma (a)} ,x>0$ï¼Œå¼ä¸­ä¼½é©¬å‡½æ•°çš„ç‰¹å¾ä¸ºï¼š$\begin{cases}  \Gamma (a)=(a-1)! & if\: a\: is\:  \mathbb{Z}^{+} \\\Gamma (a)=(a-1) \Gamma (a-1) & if\: a\: is\:  \mathbb{R}^{+} \\\ \Gamma ( \frac{1}{2}= \sqrt{ \pi }  ) \end{cases} $



```python
import numpy as np
from scipy import stats
import seaborn as sns
import math

sns.set()
mu,sigma=30,5
sample_size=1000
sample_square=np.array([sum(np.square(np.random.normal(mu, sigma, sample_size))) for i in range(2000)]) # ä»æœä»å¹³å‡å€¼ä¸º30ï¼Œæ ‡å‡†å·®ä¸º5çš„æ­£æ€åˆ†å¸ƒä¸­ï¼Œéšæœºæå–2000ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬å®¹é‡ä¸º1000çš„æ ·æœ¬ï¼Œå¹¶è®¡ç®—æ¯ä¸€æ ·æœ¬çš„å‡å€¼
bins=30
sns.histplot(sample_square,bins=bins,kde=True,legend=False) # æŸ¥çœ‹2000ä¸ªæ ·æœ¬å¹³æ–¹å’Œçš„åˆ†å¸ƒ
```




    <AxesSubplot:ylabel='Count'>




<img src="./imgs/2_1_3/output_26_1.png" height='auto' width='auto' title="caDesign">    
   


ä½¿ç”¨`SciPy`åº“è®¡ç®—æ‰“å°å¡æ–¹åˆ†å¸ƒåŠä¼½é©¬åˆ†å¸ƒã€‚


```python
import matplotlib.pyplot as plt
from scipy.stats import chi2
import numpy as np

fig, axs=plt.subplots(1,2,figsize=(18/1.5,8/1.5)) 

# A-å¡æ–¹åˆ†å¸ƒ
df=55
mean,var,skew,kurt=chi2.stats(df, moments='mvsk')
# æ‰“å°å¡æ–¹åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•° Display the probability density function (pdf)
x=np.linspace(chi2.ppf(0.01, df),chi2.ppf(0.99, df), 100)
axs[0].plot(x, chi2.pdf(x, df),'r-', lw=5, alpha=0.6, label='chi2 pdf_55')

df_lst=[20,30,40,80,100]
fmts=['b-','g-','y-','m-','c-']
for i in range(len(df_lst)):
    axs[0].plot(x, chi2.pdf(x, df_lst[i]),fmts[i], lw=3, alpha=0.6, label='chi2 pdf_%d'%df_lst[i])
    
# å›ºå®šåˆ†å¸ƒ Alternatively, freeze the distribution and display the frozen pdf
rv=chi2(df)
axs[0].plot(x, rv.pdf(x), 'k-', lw=2, label='frozen pdf_55')

vals=chi2.ppf([0.001, 0.5, 0.999], df)
print("Chi_2_Check accuracy of cdf and ppf:",np.allclose([0.001, 0.5, 0.999], chi2.cdf(vals, df)))

r=chi2.rvs(df, size=1000)
axs[0].hist(r, density=True, histtype='stepfilled', alpha=0.2)
axs[0].legend(loc='best', frameon=False)
               
# B-Gammaåˆ†å¸ƒ    
from scipy.stats import gamma
a=1.99323054838
mean_,var_,skew_,kurt_=gamma.stats(a, moments='mvsk')
# æ‰“å°Gammaåˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•° Display the probability density function (pdf):
x_= np.linspace(gamma.ppf(0.01, a),gamma.ppf(0.99, a), 100)
axs[1].plot(x_, gamma.pdf(x_, a),'r-', lw=5, alpha=0.6, label='gamma pdf')
# Alternatively, freeze the distribution and display the frozen pdf:
rv_= gamma(a)
axs[1].plot(x_, rv_.pdf(x_), 'k-', lw=2, label='frozen pdf')

vals = gamma.ppf([0.001, 0.5, 0.999], a)
print("Gamma_Check accuracy of cdf and ppf:",np.allclose([0.001, 0.5, 0.999], gamma.cdf(vals, a)))

r_=gamma.rvs(a, size=1000)
axs[1].hist(r_, density=True, histtype='stepfilled', alpha=0.2)
axs[1].legend(loc='best', frameon=False)

axs[0].set_title(r'Chi-Square Distribution', fontsize=15)
axs[1].set_title(r'Gamma Distribution', fontsize=15)
plt.show()               
```

    Chi_2_Check accuracy of cdf and ppf: True
    Gamma_Check accuracy of cdf and ppf: True
    


<img src="./imgs/2_1_3/output_28_1.png" height='auto' width='auto' title="caDesign">    
   


#### 2ï¼‰ ï¼ˆå¡æ–¹ï¼‰ç‹¬ç«‹æ€§æ£€éªŒ
å¡æ–¹æ£€éªŒï¼ˆChi-Squared Testï¼Œæˆ– $x^{2}$ Testï¼‰ï¼Œæ˜¯å‡è®¾æ£€éªŒçš„ä¸€ç§ï¼Œä¸€ç§éå‚æ•°å‡è®¾æ£€éªŒï¼Œä¸»è¦ç”¨äºç±»åˆ«/åˆ†ç±»å˜é‡ï¼ˆç±»åˆ«å˜é‡å°±æ˜¯å–å€¼ä¸ºç¦»æ•£å€¼çš„å˜é‡ï¼Œä¾‹å¦‚æ€§åˆ«å³ä¸ºä¸€ä¸ªç±»åˆ«å˜é‡ï¼Œæœ‰ç”·å¥³ä¸¤ç±»ï¼Œåˆæˆ–è€…å›½ç±ã€å­¦ç§‘ã€æ¤ç‰©ç­‰çš„ç±»åˆ«ç­‰ï¼‰ï¼Œåœ¨æ²¡æœ‰å…¶å®ƒçš„é™åˆ¶æ¡ä»¶æˆ–è¯´æ˜æ—¶ï¼Œå¡æ–¹æ£€éªŒä¸€èˆ¬æŒ‡ä»£çš„æ˜¯çš®å°”æ£®å¡æ–¹ï¼ˆPearsonï¼‰æ£€éªŒã€‚1900å¹´ï¼ŒPearsonå‘è¡¨äº†è‘—åçš„$x^{2}$æ£€éªŒçš„è®ºæ–‡ï¼Œå‡è®¾å®éªŒä¸­ä»æ€»ä½“éšæœºå–æ ·å¾—åˆ°çš„$n$ä¸ªè§‚å¯Ÿå€¼è¢«åˆ’åˆ†ä¸º$k$ä¸ªäº’æ–¥çš„åˆ†ç±»ä¸­ï¼Œè¿™æ ·æ¯ä¸ªåˆ†ç±»éƒ½æœ‰ä¸€ä¸ªå¯¹åº”å®é™…çš„è§‚å¯Ÿæ¬¡æ•°ï¼ˆæˆ–è§‚æµ‹é¢‘æ•°ï¼Œobserved frequenciesï¼‰$ x_{i} (i=1,2, \ldots ,k)$ã€‚å¯¹å®éªŒä¸­å„ä¸ªè§‚å¯Ÿå€¼è½å…¥ç¬¬$i$ä¸ªåˆ†ç±»çš„æ¦‚ç‡$p_{i}$çš„åˆ†å¸ƒæå‡ºé›¶å‡è®¾ï¼Œè·å¾—å¯¹åº”æ‰€æœ‰ç¬¬$i$åˆ†ç±»çš„ç†è®ºæœŸæœ›æ¬¡æ•°ï¼ˆæˆ–é¢„æœŸé¢‘æ•°ï¼Œexpected frequenciesï¼‰åŠé™åˆ¶æ¡ä»¶ï¼Œ$\sum_{i=1}^k  p_{i}  =1,and \: \sum_{i=1}^k  m_{i} =\sum_{i=1}^k  x_{i} =n$ã€‚åœ¨ä¸Šè¿°é›¶å‡è®¾æˆç«‹ä»¥åŠ$n$è¶‹å‘$\infty $æ—¶ï¼Œä»¥ä¸‹ç»Ÿè®¡é‡çš„æé™åˆ†å¸ƒè¶‹å‘$x^{2}$åˆ†å¸ƒï¼Œ$X^{2} = \sum_{i=1}^k  \frac{ ( x_{i} - m_{i} )^{2} }{m_{i}}  =\sum_{i=1}^k  \frac{ x_{i} ^{2} }{m_{i}} -n$ã€‚$X^{2}$å€¼çš„è®¡ç®—å…¬å¼é€šå¸¸è¡¨ç¤ºä¸ºï¼š$X^{2} =  \sum ( \frac{ (O-E)^{2} }{E} )$ï¼Œå…¶ä¸­ï¼Œ$O$ä¸ºå„ä¸ªå•å…ƒæ ¼ï¼ˆå¯¹åˆ—è”è¡¨è€Œè¨€ï¼‰çš„è§‚æµ‹å€¼ï¼ˆè§‚æµ‹é¢‘æ•°ï¼‰ï¼Œ$E$ä¸ºå„ä¸ªå•å…ƒæ ¼çš„é¢„æœŸå€¼ï¼ˆé¢„æœŸé¢‘æ•°ï¼‰ã€‚é›¶å‡è®¾ä¸­æ‰€æœ‰åˆ†ç±»çš„ç†è®ºæœŸæœ›æ¬¡æ•°$m_{i}$å‡ä¸ºè¶³å¤Ÿå¤§ä¸”å·²çŸ¥çš„æƒ…å†µï¼ŒåŒæ—¶å‡è®¾å„åˆ†ç±»çš„å®é™…è§‚å¯Ÿæ¬¡æ•°$x_{i}$å‡æœä»æ­£æ€åˆ†å¸ƒï¼Œå¾—å‡ºæ ·æœ¬å®¹é‡$n$è¶³å¤Ÿå¤§æ—¶ï¼Œ$x^{2}$è¶‹è¿‘æœä»è‡ªç”±åº¦ä¸º$(k-1)$çš„$x^{2}$åˆ†å¸ƒã€‚

é€šå¸¸å°†ç”¨äºå¡æ–¹æ£€éªŒçš„æ•°æ®ä»¥è¡¨æ ¼çš„å½¢å¼ç»™å‡ºå¹¶ä¾æ®è¡¨æ ¼è¿›è¡Œè®¡ç®—ï¼Œè¿™ä¸ªè¡¨æ ¼å³ä¸ºåˆ—è”è¡¨ï¼ˆcontingency tabelï¼‰ã€‚ä»¥ã€Šç™½è¯ç»Ÿè®¡å­¦ã€‹æ€§åˆ«ä¸ä¸“ä¸šçš„ä¿®è®¢æ•°æ®ä¸ºä¾‹ï¼Œ


| æ€§åˆ«/ä¸“ä¸š      | å¿ƒç†å­¦ | è‹±è¯­     |ç”Ÿç‰©å­¦ |è¡Œåˆè®¡     |
| :---        |    :----:   |          ---: | ---: |---: |
| ç”·ç”Ÿ      | 35       | 50  |15|100|
| å¥³ç”Ÿ      | 30        | 25      |45|100|
| åˆ—åˆè®¡      | 65        | 75      |60|200|

åˆ©ç”¨è¡¨æ ¼æ¯ä¸€å•å…ƒæ ¼ä¸­çš„è§‚æµ‹é¢‘æ•°ï¼ŒåŠè¡Œã€åˆ—å’Œæ•´ä¸ªæ ·æœ¬çš„åˆè®¡é¢‘æ•°ï¼Œè®¡ç®—æ¯ä¸ªå•å…ƒæ ¼çš„é¢„æœŸé¢‘æ•°ã€‚ç”·å¥³ä¸¤è¡Œä¸­æ¯ä¸€å•å…ƒæ ¼çš„é¢„æœŸå€¼éƒ½ç›¸ç­‰ï¼Œæ˜¯å› ä¸ºæ ·æœ¬ä¸­çš„ç”·å¥³ç”Ÿäººæ•°ç›¸ç­‰ã€‚å¹¶æ ¹æ®ä¸Šè¿°çš„$X^{2}$å€¼çš„è®¡ç®—å…¬å¼ï¼Œè®¡ç®—$X^{2}$ï¼Œå…¶å’Œä¸ºï¼š0.19+0.19+4.17+4.17+7.5+7.5=23.72ã€‚

| æ€§åˆ«/ä¸“ä¸š      | å¿ƒç†å­¦ | è‹±è¯­     |ç”Ÿç‰©å­¦ |
| :---        |    :----  |          :---| :--- |
| ç”·ç”Ÿ      |    è§‚æµ‹é¢‘æ•°ï¼š35 </br>é¢„æœŸé¢‘æ•°ï¼š$\frac{100 \times 65}{200} =32.5$ </br>$x^{2}$å€¼ï¼š$ \frac{ (35-32.5)^{2} }{32.5} =0.19$   |è§‚æµ‹é¢‘æ•°ï¼š50 </br> é¢„æœŸé¢‘æ•°:$\frac{100 \times 75}{200} =37.5$</br> $x^{2}$å€¼ï¼š$ \frac{ (50-37.5)^{2} }{37.5} =4.17$ |è§‚æµ‹é¢‘æ•°ï¼š15 </br> é¢„æœŸé¢‘æ•°: $\frac{100 \times 60}{200} =30$</br> $x^{2}$å€¼ï¼š$ \frac{ (15-30)^{2} }{30} =7.5$ |
| å¥³ç”Ÿ      | è§‚æµ‹é¢‘æ•°ï¼š30 </br>é¢„æœŸé¢‘æ•° $\frac{100 \times 65}{200} =32.5$ </br>$x^{2}$å€¼ï¼š$ \frac{ (30-32.5)^{2} }{32.5} =0.19$    |è§‚æµ‹é¢‘æ•°ï¼š25 </br> é¢„æœŸé¢‘æ•°:  $\frac{100 \times 75}{200} =37.5$ </br>$x^{2}$å€¼ï¼š$ \frac{ (25-37.5)^{2} }{37.5} =4.17$ | è§‚æµ‹é¢‘æ•°ï¼š45 </br> é¢„æœŸé¢‘æ•°: $\frac{100 \times 60}{200} =30$</br>$x^{2}$å€¼ï¼š$ \frac{ (45-30)^{2} }{30} =7.5$ |

æ³¨æ„åˆ°$x^{2}$å€¼è¾ƒå¤§æ˜¯å› ä¸ºç”·å¥³ç”Ÿåœ¨é€‰æ‹©è‹±è¯­æˆ–ç”Ÿç‰©ä¸“ä¸šæ—¶å­˜åœ¨ç›¸å¯¹è¾ƒå¤§çš„å·®å¼‚ã€‚è€Œå¿ƒç†å­¦ä¸“ä¸šçš„è§‚æµ‹å€¼å’Œé¢„æœŸå€¼ä¹‹å·®ç›¸å¯¹è¾ƒå°ï¼Œå¯¹æ•´ä½“$x^{2}$å€¼çš„è´¡çŒ®ä¸å¤§ã€‚è·å¾—è§‚æµ‹çš„$x^{2}$å€¼ï¼Œåˆ™éœ€è¦æŸ¥è¡¨ï¼ˆæˆ–ç¨‹åºï¼‰æŸ¥æ‰¾ä¸´ç•Œ$x^{2}$å€¼ï¼Œå…¶è‡ªç”±åº¦$df=(R-1)(C-1)=(2-1)\times(3-1)=2$ï¼Œä½¿ç”¨`SciPy`çš„`chi2.ppf(q=1-0.05,df=2)`è®¡ç®—å¯å¾—0.05çš„$\alpha $æ°´å¹³ï¼Œè‡ªç”±åº¦ä¸º2çš„æ¡ä»¶ä¸‹ä¸´ç•Œ$x^{2}$å€¼ä¸º5.99ï¼Œè€Œè§‚æµ‹çš„$x^{2}$å€¼ä¸º23.72ï¼Œæ‰€ä»¥å¯ä»¥å¾—å‡ºç»“è®ºï¼Œç”·å¥³ç”Ÿåœ¨ä¸“ä¸šé€‰æ‹©ä¸Šå­˜åœ¨ç»Ÿè®¡æ˜¾è‘—çš„å·®å¼‚ã€‚è€Œå› ä¸ºè§‚æµ‹çš„$x^{2}$å€¼è¶³å¤Ÿå¤§ï¼Œåœ¨0.001çš„æ˜¾è‘—æ€§æ°´å¹³ä¸Š`chi2.ppf(q=1-0.001,df=2)`ï¼ˆä¸´ç•Œå€¼ä¸º13.815510557964274ï¼‰ï¼Œä¹Ÿæ˜¯ç»Ÿè®¡æ˜¾è‘—çš„ï¼ˆå³$p<0.001$ï¼‰ã€‚


```python
print("ğ‘<0.05,df=2,Chi-Squared=%.3f"%chi2.ppf(q=1-0.05,df=2))
print("ğ‘<0.001,df=2,Chi-Squared=%.3f"%chi2.ppf(q=1-0.001,df=2))
```

    ğ‘<0.05,df=2,Chi-Squared=5.991
    ğ‘<0.001,df=2,Chi-Squared=13.816
    

ä½¿ç”¨`SciPy`çš„`chi2_contingency`æ–¹æ³•è®¡ç®—åˆ—è”è¡¨ï¼Œå…¶è®¡ç®—ç»“æœä¸æ‰‹å·¥è®¡ç®—ç»“æœä¿æŒä¸€è‡´ã€‚


```python
from scipy.stats import chi2_contingency
import numpy as np

schoolboy=(35,50,15)
schoolgirl=(30,25,45)
statistical_data=np.array([schoolboy,schoolgirl])
chi2_results=chi2_contingency(statistical_data)
print("å¡æ–¹å€¼ï¼š%.3f \n På€¼ï¼š%.10f \n è‡ªç”±åº¦:%d \n å¯¹åº”é¢„æœŸé¢‘æ•°ï¼ˆæœŸæœ›å€¼ï¼‰ï¼š\n %s"%chi2_results)
```

    å¡æ–¹å€¼ï¼š23.718 
     På€¼ï¼š0.0000070748 
     è‡ªç”±åº¦:2 
     å¯¹åº”é¢„æœŸé¢‘æ•°ï¼ˆæœŸæœ›å€¼ï¼‰ï¼š
     [[32.5 37.5 30. ]
     [32.5 37.5 30. ]]
    

#### 3ï¼‰ åæ–¹å·®ä¼°è®¡ï¼ˆCovariance Estimatorsï¼‰
ç»Ÿè®¡å­¦ä¸Šå¸¸ç”¨çš„ç»Ÿè®¡é‡åŒ…æ‹¬å¹³å‡å€¼ã€æ–¹å·®ã€æ ‡å‡†å·®ç­‰ã€‚å¹³å‡å€¼æè¿°äº†æ ·æœ¬é›†åˆçš„ä¸­é—´ç‚¹ï¼›æ–¹å·®æè¿°äº†ä¸€ç»„æ•°æ®ä¸å…¶å¹³å‡å€¼çš„åç¦»ç¨‹åº¦ï¼Œæ–¹å·®è¶Šå°ï¼Œæ•°æ®è¶Šé›†ä¸­ï¼Œæ–¹å·®è¶Šå¤§ï¼Œæ•°æ®è¶Šç¦»æ•£ï¼›æ ‡å‡†å·®æè¿°äº†æ ·æœ¬é›†ä¸­å„ä¸ªæ ·æœ¬ç‚¹åˆ°å‡å€¼çš„è·ç¦»çš„å¹³å‡å€¼ï¼ŒåŒæ–¹å·®ï¼Œæè¿°æ•°æ®é›†çš„é›†èšç¦»æ•£ç¨‹åº¦ã€‚è¿™äº›ç»Ÿè®¡é‡æ˜¯é’ˆå¯¹ä¸€ç»´æ•°ç»„ï¼Œåˆ°å¤„ç†é«˜ç»´æ—¶ï¼Œç”¨åˆ°åæ–¹å·®ï¼Œåº¦é‡å¤šä¸ªéšæœºå˜é‡å…³ç³»çš„ç»Ÿè®¡é‡ï¼Œç»“æœå‡ä¸ºæ­£åˆ™æ­£ç›¸å…³ï¼Œéƒ½ä¸ºè´Ÿåˆ™è´Ÿç›¸å…³ï¼Œå‡è¶‹è¿‘äº0ï¼Œåˆ™ä¸ç›¸å…³ã€‚åæ–¹å·®æ˜¯è®¡ç®—ä¸åŒç‰¹å¾ä¹‹é—´çš„ç»Ÿè®¡é‡ï¼Œä¸æ˜¯ä¸åŒæ ·æœ¬ä¹‹é—´çš„ç»Ÿè®¡é‡ã€‚åŒæ—¶ï¼Œåæ–¹å·®çš„å¤§å°ï¼Œé™¤äº†å’Œå˜é‡ä¹‹é—´çš„ç›¸å…³ç¨‹åº¦æœ‰å…³ï¼Œä¹Ÿä¸å˜é‡æœ¬èº«çš„æ–¹å·®å¤§å°æœ‰å…³ï¼Œå› æ­¤å¼•å…¥ç›¸å…³ç³»æ•°ï¼Œç§»é™¤å˜é‡æœ¬èº«çš„å½±å“ã€‚åœ¨åæ–¹å·®è®¡ç®—æ—¶å¯ä»¥ä½¿ç”¨åæ–¹å·®ï¼ˆçŸ©é˜µï¼‰è®¡ç®—å…¬å¼ï¼ˆæŸ¥çœ‹æ–¹å·®å’Œåæ–¹å·®éƒ¨åˆ†ï¼‰ï¼Œè€Œæœ‰æ—¶å¹¶ä¸ä½¿ç”¨å…¨éƒ¨çš„æ ·æœ¬æ•°æ®è®¡ç®—åæ–¹å·®çŸ©é˜µï¼Œè€Œæ˜¯åˆ©ç”¨éƒ¨åˆ†æ ·æœ¬æ•°æ®è®¡ç®—ï¼Œè¿™æ˜¯å°±éœ€è¦è€ƒè™‘æ ·æœ¬è®¡ç®—å¾—åˆ°çš„åæ–¹å·®çŸ©é˜µæ˜¯å¦å’Œæ€»ä½“çš„åæ–¹å·®çŸ©é˜µç›¸åŒå’Œè¿‘ä¼¼ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä¼°è®¡æ€»ä½“çš„åæ–¹å·®çŸ©é˜µå¿…é¡»åœ¨æ ·æœ¬çš„æ€§è´¨ï¼ˆå¤§å°sizeï¼Œç»“æ„structureï¼ŒåŒè´¨æ€§homogeneityï¼‰å¯¹ä¼°è®¡è´¨é‡æœ‰å¾ˆå¤§å½±å“ä¸‹è¿›è¡Œï¼Œåœ¨`sklearn.covariance`æ¨¡å—ä¸­åˆ™æä¾›äº†å¤šä¸ªå¥å£®çš„åæ–¹å·®ä¼°è®¡ç®—æ³•ï¼Œåˆ—è¡¨å¦‚ä¸‹ï¼š

| åæ–¹å·®ä¼°è®¡æ–¹æ³•                                        | è§£é‡Š                                                                     |
|------------------------------------------------|------------------------------------------------------------------------|
| covariance.EmpiricalCovariance(*[,Â â€¦])         | æœ€å¤§ä¼¼ç„¶åæ–¹å·®ä¼°è®¡ Maximum likelihood covariance estimator                                |
| covariance.EllipticEnvelope(*[,Â â€¦])            | ç”¨äºæ£€æµ‹é«˜æ–¯åˆ†å¸ƒæ•°æ®é›†ä¸­å¼‚å¸¸å€¼çš„å¯¹è±¡ An object for detecting outliers in a Gaussian distributed dataset.    |
| covariance.GraphicalLasso([alpha,Â mode,Â â€¦])    | å¸¦L1æƒ©ç½šä¼°è®¡é‡çš„ç¨€ç–é€†åæ–¹å·®ä¼°è®¡ Sparse inverse covariance estimation with an l1-penalized estimator.   |
| covariance.GraphicalLassoCV(*[,Â alphas,Â â€¦])    | ç¨€ç–é€†åæ–¹å·®w/äº¤å‰éªŒè¯l1æƒ©ç½šçš„é€‰æ‹© Sparse inverse covariance w/ cross-validated choice of the l1 penalty. |
| covariance.LedoitWolf(*[,Â store_precision,Â â€¦]) |LedoitWolfä¼°è®¡é‡  LedoitWolf Estimator                                                   |
| covariance.MinCovDet(*[,Â store_precision,Â â€¦])  |æœ€å°åæ–¹å·®è¡Œåˆ—å¼(MCD):åæ–¹å·®çš„ç¨³å¥ä¼°è®¡  Minimum Covariance Determinant (MCD): robust estimator of covariance.  |
| covariance.OAS(*[,Â store_precision,Â â€¦])        |Oracleé€¼è¿‘æ”¶ç¼©ä¼°è®¡  Oracle Approximating Shrinkage Estimator                               |
| covariance.ShrunkCovariance(*[,Â â€¦])            |åæ–¹å·®ç¼©æ°´ï¼ˆshrinkageï¼‰ä¼°è®¡ Covariance estimator with shrinkage                                    |
| covariance.empirical_covariance(X,Â *[,Â â€¦])     |è®¡ç®—æœ€å¤§ä¼¼ç„¶åæ–¹å·®ä¼°è®¡é‡ Computes the Maximum likelihood covariance estimator                   |
| covariance.graphical_lasso(emp_cov,Â alpha,Â *)  | l1-æƒ©ç½šé¡¹åæ–¹å·®ä¼°è®¡é‡ l1-penalized covariance estimator                                      |
| covariance.ledoit_wolf(X,Â *[,Â â€¦])              | ä¼°è®¡ç¼©æ°´çš„Ledoit-Wolfåæ–¹å·®çŸ©é˜µ Estimates the shrunk Ledoit-Wolf covariance matrix.                    |
| covariance.oas(X,Â *[,Â assume_centered])        |ç”¨Oracleè¿‘ä¼¼ç¼©æ°´ç®—æ³•ä¼°è®¡åæ–¹å·® Estimate covariance with the Oracle Approximating Shrinkage algorithm. |
| covariance.shrunk_covariance(emp_cov[,Â â€¦])     |è®¡ç®—åœ¨å¯¹è§’çº¿ä¸Šç¼©æ°´çš„åæ–¹å·®çŸ©é˜µ Calculates a covariance matrix shrunk on the diagonal                  |

ä¸‹è¿°å‡è®¾äº†ä¸€ä¸ªåæ–¹å·®çŸ©é˜µï¼Œå¹¶æ ¹æ®è¯¥åæ–¹å·®çŸ©é˜µç”Ÿäº§ä¸€ç»„æ•°æ®é›†ï¼Œåˆ†å¸ƒä½¿ç”¨äº†`sklearn.covariance `æä¾›çš„`GraphicalLassoCV`ï¼Œ`EmpiricalCovariance`ï¼Œ`MinCovDet`ï¼ŒåŠ`NumPy`åº“æä¾›çš„`np.cov()`æ–¹æ³•è¿›è¡Œè®¡ç®—æ¯”è¾ƒè§‚å¯Ÿï¼Œå…¶ç»“æœç›¸è¿‘ï¼Œå‘çœŸå®å‡è®¾çš„åæ–¹å·®çŸ©é˜µå€¼é è¿‘ã€‚


```python
import numpy as np
from sklearn.covariance import GraphicalLassoCV,EmpiricalCovariance,MinCovDet

# å‡è®¾çš„åæ–¹å·®çŸ©é˜µï¼ŒåŒ…å«4ä¸ªç‰¹å¾é‡
true_cov=np.array([[0.8, 0.0, 0.2, 0.0],
                  [0.0, 0.4, 0.0, 0.0],
                  [0.2, 0.0, 0.3, 0.1],
                  [0.0, 0.0, 0.1, 0.7]])
np.random.seed(0)
# ç”Ÿæˆæ»¡è¶³å‡è®¾åæ–¹å·®çŸ©é˜µçš„ç‰¹å¾å€¼
X=np.random.multivariate_normal(mean=[0, 0, 0, 0], cov=true_cov,size=200)
# A-ä½¿ç”¨GraphicalLassoCVæ–¹æ³•
cov=GraphicalLassoCV().fit(X)
print("A-GraphicalLassoCV algorithm:\n{},estimated location(the estimated mean):{}".format(np.around(GraphicalLassoCV().fit(X).covariance_, decimals=3),np.around(cov.location_, decimals=3)))

# B-EmpiricalCovariance
print("A-EmpiricalCovariance algorithm:\n{}".format(np.around(EmpiricalCovariance().fit(X).covariance_, decimals=3)))

# C-MinCovDet
print("A-MinCovDet:\n{}".format(np.around(MinCovDet().fit(X).covariance_, decimals=3)))

# D-np.cov
print("A-np.cov:\n{}".format(np.around(np.cov(X.T), decimals=3)))
```

    A-GraphicalLassoCV algorithm:
    [[0.816 0.051 0.22  0.017]
     [0.051 0.364 0.018 0.036]
     [0.22  0.018 0.322 0.094]
     [0.017 0.036 0.094 0.69 ]],estimated location(the estimated mean):[0.073 0.04  0.038 0.143]
    A-EmpiricalCovariance algorithm:
    [[0.816 0.059 0.228 0.009]
     [0.059 0.364 0.025 0.044]
     [0.228 0.025 0.322 0.103]
     [0.009 0.044 0.103 0.69 ]]
    A-MinCovDet:
    [[ 0.741 -0.005  0.162  0.089]
     [-0.005  0.305  0.024  0.061]
     [ 0.162  0.024  0.237  0.117]
     [ 0.089  0.061  0.117  0.55 ]]
    A-np.cov:
    [[0.82  0.059 0.229 0.009]
     [0.059 0.366 0.025 0.044]
     [0.229 0.025 0.324 0.103]
     [0.009 0.044 0.103 0.694]]
    

### 2.1.3.4 å…¬å…±å¥åº·æ•°æ®çš„åœ°ç†ç©ºé—´åˆ†å¸ƒä¸ç›¸å…³æ€§åˆ†æ

#### 1ï¼‰å…¬å…±å¥åº·æ•°æ®çš„åœ°ç†ç©ºé—´åˆ†å¸ƒ

å…¬å…±å¥åº·æ•°æ®ä¸ºèŠåŠ å“¥ç¤¾åŒºé€‰å®šçš„å…¬å…±å¥åº·ï¼ˆå«ç”Ÿï¼‰æŒ‡æ ‡ï¼ˆpublic health indicatorï¼‰ã€‚è¯¥æ•°æ®é›†åŒ…æ‹¬27é¡¹é‡è¦çš„å…¬å…±å¥åº·æŒ‡æ ‡ï¼Œè¿™äº›æŒ‡æ ‡ä¸ºæ¯”ç‡ã€ç™¾åˆ†æ¯”ã€æˆ–è€…å‡ºç”Ÿç‡ã€æ­»äº¡ç‡ã€ä¼ æŸ“ç—…ã€é“…ä¸­æ¯’åŠç»æµçŠ¶å†µç›¸å…³çš„æŒ‡æ ‡ã€‚è¯¥æ•°æ®é›†æ˜¯æŒ‰ç…§ç¤¾åŒºè¿›è¡Œç»Ÿè®¡ï¼Œåœ¨å­—æ®µä¸­ç»™å‡ºäº†ç¤¾åŒºåï¼Œå› æ­¤å¯ä»¥å°†æ•°æ®æŒ‰ç…§ç¤¾åŒºåé…å¯¹åˆ°å„ä¸ªç¤¾åŒºèŒƒå›´çš„åœ°ç†ç©ºé—´æ•°æ®ä¸Šã€‚èŠåŠ å“¥ç¤¾åŒºè¾¹ç•ŒåŠå…¬å…±å¥åº·æ•°æ®å‡æ¥æºäº[Chicago Data Portalï¼ŒCDP](https://data.cityofchicago.org/)<sup>â‘¡</sup>ã€‚å…³äºæ•°æ®çš„ç»†èŠ‚æè¿°å¯ä»¥å‚è€ƒCDPæä¾›çš„æ–‡ä»¶ã€‚

> åœ¨JupyterLabä¸­æ‰“å°æ•°æ®çš„æ–¹å¼ï¼ŒåŒ…æ‹¬`print()`å’Œç›´æ¥å°†è¦æ˜¾ç¤ºæ•°æ®çš„å˜é‡æ”¾ç½®äºå•ä¸ªå•å…ƒæ ¼ï¼ˆcellï¼‰ä¸¤ç§æ–¹å¼ã€‚ä½†æ˜¯å‰è€…æ˜¾ç¤ºä¸ºå›ºå®šå®½åº¦ï¼Œä¸èƒ½æŒ‰ç…§å±å¹•å®½åº¦è‡ªåŠ¨ç¼©æ”¾ï¼Œåè€…è™½ä¸º100%å®½åº¦è‡ªåŠ¨ç¼©æ”¾æ˜¾ç¤ºï¼Œä½†æ˜¯å¦‚æœè¦å°†.ipynbçš„Jupyteræ–‡ä»¶è¾“å‡ºä¸º.mdçš„Mardownæ–‡ä»¶ï¼Œå¯èƒ½ä¼šäº§ç”Ÿä¹±ç ã€‚å› æ­¤ï¼Œå¯ä»¥ä½¿ç”¨`from IPython.display import HTML`ï¼Œå°†è¦æ˜¾ç¤ºçš„æ•°æ®è½¬æ¢ä¸ºHTMLæ ¼å¼æ•°æ®åï¼Œä¼šè§£å†³ä¸Šè¿°ä¸¤ç§é—®é¢˜ã€‚


```python
import pandas as pd

dataFp_dic={
    "ublic_Health_Statistics_byCommunityArea_fp":r'./data/Public_Health_Statistics_Selected_public_health_indicators_by_Chicago_community_area.csv',
    "Boundaries_Community_Areas_current":r'./data/ChicagoCommunityAreas/ChicagoCommunityAreas.shp',    
}

pubicHealth_Statistic=pd.read_csv(dataFp_dic["ublic_Health_Statistics_byCommunityArea_fp"])

# ä¸­è‹±å¯¹ç…§è¡¨ï¼ˆå­—æ®µæ˜ å°„è¡¨ï¼‰
PubicHealth_Statistic_columns={'Community Area':'ç¤¾åŒº', 
                                'Community Area Name':'ç¤¾åŒºå',
                                'Birth Rate':'å‡ºç”Ÿç‡',
                                'General Fertility Rate':'ä¸€èˆ¬ç”Ÿè‚²ç‡',
                                'Low Birth Weight':'ä½å‡ºç”Ÿä½“é‡',
                                'Prenatal Care Beginning in First Trimester':'äº§å‰3ä¸ªæœˆæŠ¤ç†', 
                                'Preterm Births':'æ—©äº§',
                                'Teen Birth Rate':'é’å°‘å¹´ç”Ÿè‚²ç‡',
                                'Assault (Homicide)':'æ”»å‡»ï¼ˆæ€äººï¼‰',
                                'Breast cancer in females':'å¥³æ€§ä¹³è…ºç™Œ',
                                'Cancer (All Sites)':'ç™Œç—‡', 
                                'Colorectal Cancer':'ç»“è‚ ç›´è‚ ç™Œ',
                                'Diabetes-related':'ç³–å°¿ç—…ç›¸å…³',
                                'Firearm-related':'æªæ”¯ç›¸å…³',
                                'Infant Mortality Rate':'å©´å„¿æ­»äº¡ç‡', 
                                'Lung Cancer':'è‚ºç™Œ',
                                'Prostate Cancer in Males':'ç”·æ€§å‰åˆ—è…ºç™Œ',
                                'Stroke (Cerebrovascular Disease)':'ä¸­é£(è„‘è¡€ç®¡ç–¾ç—…)',
                                'Childhood Blood Lead Level Screening':'å„¿ç«¥è¡€é“…æ°´å¹³æ£€æŸ¥',
                                'Childhood Lead Poisoning':'å„¿ç«¥é“…ä¸­æ¯’',
                                'Gonorrhea in Females':'å¥³æ€§æ·‹ç—…', 
                                'Gonorrhea in Males':'ç”·æ€§æ·‹ç—…', 
                                'Tuberculosis':'è‚ºç»“æ ¸',
                                'Below Poverty Level':'è´«å›°æ°´å¹³ä»¥ä¸‹', 
                                'Crowded Housing':'æ‹¥æŒ¤çš„ä½æˆ¿', 
                                'Dependency':'ä¾èµ–',
                                'No High School Diploma':'æ²¡æœ‰é«˜ä¸­æ–‡å‡­', 
                                'Per Capita Income':'äººå‡æ”¶å…¥',
                                'Unemployment':'å¤±ä¸š',
                                }

def print_html(df,row_numbers=5):    
    '''
    function - åœ¨Jupyterä¸­æ‰“å°DataFrameæ ¼å¼æ•°æ®ä¸ºHTML
    
    Params:
        df - éœ€è¦æ‰“å°çš„DataFrameæˆ–GeoDataFrameæ ¼å¼æ•°æ®ï¼›DataFrame
        row_numbers - æ‰“å°çš„è¡Œæ•°ï¼Œå¦‚æœä¸ºæ­£ï¼Œä»å¼€å§‹æ‰“å°å¦‚æœä¸ºè´Ÿï¼Œä»æœ«å°¾æ‰“å°ï¼›int
        
    Returns:
        è½¬æ¢åçš„HTMLæ ¼å¼æ•°æ®ï¼›
     '''
    from IPython.display import HTML
    
    if row_numbers>0:
        return HTML(df.head(row_numbers).to_html())
    else:
        return HTML(df.tail(abs(row_numbers)).to_html())
print_html(pubicHealth_Statistic,6)
```



<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Community Area</th>
      <th>Community Area Name</th>
      <th>Birth Rate</th>
      <th>General Fertility Rate</th>
      <th>Low Birth Weight</th>
      <th>Prenatal Care Beginning in First Trimester</th>
      <th>Preterm Births</th>
      <th>Teen Birth Rate</th>
      <th>Assault (Homicide)</th>
      <th>Breast cancer in females</th>
      <th>Cancer (All Sites)</th>
      <th>Colorectal Cancer</th>
      <th>Diabetes-related</th>
      <th>Firearm-related</th>
      <th>Infant Mortality Rate</th>
      <th>Lung Cancer</th>
      <th>Prostate Cancer in Males</th>
      <th>Stroke (Cerebrovascular Disease)</th>
      <th>Childhood Blood Lead Level Screening</th>
      <th>Childhood Lead Poisoning</th>
      <th>Gonorrhea in Females</th>
      <th>Gonorrhea in Males</th>
      <th>Tuberculosis</th>
      <th>Below Poverty Level</th>
      <th>Crowded Housing</th>
      <th>Dependency</th>
      <th>No High School Diploma</th>
      <th>Per Capita Income</th>
      <th>Unemployment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Rogers Park</td>
      <td>16.4</td>
      <td>62.0</td>
      <td>11.0</td>
      <td>73.0</td>
      <td>11.2</td>
      <td>40.8</td>
      <td>7.7</td>
      <td>23.3</td>
      <td>176.9</td>
      <td>25.3</td>
      <td>77.1</td>
      <td>5.2</td>
      <td>6.4</td>
      <td>36.7</td>
      <td>21.7</td>
      <td>33.7</td>
      <td>364.7</td>
      <td>0.5</td>
      <td>322.5</td>
      <td>423.3</td>
      <td>11.4</td>
      <td>22.7</td>
      <td>7.9</td>
      <td>28.8</td>
      <td>18.1</td>
      <td>23714</td>
      <td>7.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>West Ridge</td>
      <td>17.3</td>
      <td>83.3</td>
      <td>8.1</td>
      <td>71.1</td>
      <td>8.3</td>
      <td>29.9</td>
      <td>5.8</td>
      <td>20.2</td>
      <td>155.9</td>
      <td>17.3</td>
      <td>60.5</td>
      <td>3.7</td>
      <td>5.1</td>
      <td>36.0</td>
      <td>14.2</td>
      <td>34.7</td>
      <td>331.4</td>
      <td>1.0</td>
      <td>141.0</td>
      <td>205.7</td>
      <td>8.9</td>
      <td>15.1</td>
      <td>7.0</td>
      <td>38.3</td>
      <td>19.6</td>
      <td>21375</td>
      <td>7.9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Uptown</td>
      <td>13.1</td>
      <td>50.5</td>
      <td>8.3</td>
      <td>77.7</td>
      <td>10.3</td>
      <td>35.1</td>
      <td>5.4</td>
      <td>21.3</td>
      <td>183.3</td>
      <td>20.5</td>
      <td>80.0</td>
      <td>4.6</td>
      <td>6.5</td>
      <td>50.5</td>
      <td>25.2</td>
      <td>41.7</td>
      <td>353.7</td>
      <td>0.5</td>
      <td>170.8</td>
      <td>468.7</td>
      <td>13.6</td>
      <td>22.7</td>
      <td>4.6</td>
      <td>22.2</td>
      <td>13.6</td>
      <td>32355</td>
      <td>7.7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Lincoln Square</td>
      <td>17.1</td>
      <td>61.0</td>
      <td>8.1</td>
      <td>80.5</td>
      <td>9.7</td>
      <td>38.4</td>
      <td>5.0</td>
      <td>21.7</td>
      <td>153.2</td>
      <td>8.6</td>
      <td>55.4</td>
      <td>6.1</td>
      <td>3.8</td>
      <td>43.1</td>
      <td>27.6</td>
      <td>36.9</td>
      <td>273.3</td>
      <td>0.4</td>
      <td>98.8</td>
      <td>195.5</td>
      <td>8.5</td>
      <td>9.5</td>
      <td>3.1</td>
      <td>25.6</td>
      <td>12.5</td>
      <td>35503</td>
      <td>6.8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>North Center</td>
      <td>22.4</td>
      <td>76.2</td>
      <td>9.1</td>
      <td>80.4</td>
      <td>9.8</td>
      <td>8.4</td>
      <td>1.0</td>
      <td>16.6</td>
      <td>152.1</td>
      <td>26.1</td>
      <td>49.8</td>
      <td>1.0</td>
      <td>2.7</td>
      <td>42.4</td>
      <td>15.1</td>
      <td>41.6</td>
      <td>178.1</td>
      <td>0.9</td>
      <td>85.4</td>
      <td>188.6</td>
      <td>1.9</td>
      <td>7.1</td>
      <td>0.2</td>
      <td>25.5</td>
      <td>5.4</td>
      <td>51615</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>Lake View</td>
      <td>13.5</td>
      <td>38.7</td>
      <td>6.3</td>
      <td>79.1</td>
      <td>8.1</td>
      <td>15.8</td>
      <td>1.4</td>
      <td>20.1</td>
      <td>126.9</td>
      <td>13.0</td>
      <td>38.5</td>
      <td>1.8</td>
      <td>2.2</td>
      <td>32.5</td>
      <td>17.0</td>
      <td>24.4</td>
      <td>179.2</td>
      <td>0.4</td>
      <td>81.8</td>
      <td>357.6</td>
      <td>3.2</td>
      <td>10.5</td>
      <td>1.2</td>
      <td>16.5</td>
      <td>2.9</td>
      <td>58227</td>
      <td>4.7</td>
    </tr>
  </tbody>
</table>



åœ¨æ•°æ®åˆå¹¶æ—¶ï¼Œå…¬å…±å¥åº·æ•°æ®ä»¥"Community Area"ä¸ºå¯¹ä½åˆ—ï¼Œç¤¾åŒºè¾¹ç•Œæ•°æ®ä»¥"area_numbe"ä¸ºå¯¹ä½åˆ—ï¼Œä½¿ç”¨`df.merge()`æ–¹æ³•å®Œæˆèåˆã€‚æ‰“å°ä¸¤ç»„æ•°æ®ï¼Œå…¶ä¸­è‚ºç™Œï¼ˆLung Cancerï¼‰ä¸ºæ¯100,000äººæ‰€å çš„æ¯”ä¾‹ã€‚GeoDataFrameæ ¼å¼æ•°æ®åœ¨æ‰“å°æ—¶å¦‚æœéœ€è¦åœ¨å›¾ä¸Šæ¯ä¸ªPolygonä¸Šæ ‡æ³¨æ•°æ®å¢åŠ åœ°å›¾çš„ä¿¡æ¯é‡ï¼Œå¯ä»¥æŒ‰ç…§ä¸‹è¿°ä»£ç å¤„ç†ã€‚


```python
import geopandas as gpd
from mpl_toolkits.axes_grid1 import make_axes_locatable
import matplotlib.pyplot as plt

community_area=gpd.read_file(dataFp_dic["Boundaries_Community_Areas_current"])
print(community_area.dtypes) 
community_area.area_numbe=community_area.area_numbe.astype('int64')
print("_"*50)
print("boundaries_community.area_numbe dtype:",community_area.area_numbe.dtypes)
pubicHealth_gpd=community_area.merge(pubicHealth_Statistic,left_on='area_numbe', right_on='Community Area')

fig, axs=plt.subplots(1,2,figsize=(40, 40))

# æ‰“å°ç¬¬1ç»„æ•°æ®
divider=make_axes_locatable(axs[0]) 
cax_0=divider.append_axes("left", size="5%", pad=0.1) # é…ç½®å›¾ä¾‹å‚æ•°
pubicHealth_gpd.plot(column='Lung Cancer',ax=axs[0],cax=cax_0,legend=True,cmap='OrRd')  # å¦‚æœæç¤ºå¦‚ä¸‹é”™è¯¯ï¼Œåˆ™éœ€è¦æŒ‰ç…§ä¿¡æ¯å®‰è£…å¯¹åº”çš„åº“,ImportError: The descartes package is required for plotting polygons in geopandas. You can install it using 'conda install -c conda-forge descartes' or 'pip install descartes'.
axs[0].set_title("Lung Cancer-Per 100,000 males (age adjusted)",fontsize=20)
pubicHealth_gpd.apply(lambda x: axs[0].annotate(text=x["Lung Cancer"], xy=x.geometry.centroid.coords[0], ha='center'),axis=1) #å¢åŠ æ ‡æ³¨
axs[0].tick_params(axis='both', labelsize=15)
cb_ax_0=axs[0].figure.axes[2]
cb_ax_0.tick_params(labelsize=15)

# æ‰“å°ç¬¬2ç»„æ•°æ®
divider=make_axes_locatable(axs[1])
cax_1=divider.append_axes("right", size="5%", pad=0.1)
pubicHealth_gpd.plot(column='Per Capita Income',ax=axs[1],cax=cax_1,legend=True,cmap='OrRd')
axs[1].set_title("Per Capita Income-2011 inflation-adjusted dollars",fontsize=20)
pubicHealth_gpd.apply(lambda x: axs[1].annotate(text=x["Community Area Name"], xy=x.geometry.centroid.coords[0], ha='center'),axis=1)
axs[1].tick_params(axis='both', labelsize=15)
cb_ax_1=axs[1].figure.axes[3]
cb_ax_1.tick_params(labelsize=15)

plt.show()
```

    area           float64
    area_num_1      object
    area_numbe      object
    comarea        float64
    comarea_id     float64
    community       object
    perimeter      float64
    shape_area     float64
    shape_len      float64
    geometry      geometry
    dtype: object
    __________________________________________________
    boundaries_community.area_numbe dtype: int64
    


<img src="./imgs/2_1_3/output_38_1.png" height='auto' width='auto' title="caDesign">    
   


#### 2ï¼‰å…¬å…±å¥åº·æ•°æ®çš„ç›¸å…³æ€§åˆ†æ

è§‚å¯Ÿä¸Šå›¾ï¼Œä¼¼ä¹è‚ºç™Œçš„å‘ç”Ÿæ¯”ä¾‹ä¸æ”¶å…¥å¤šå°‘æœ‰å…³è”ï¼Œæ”¶å…¥é«˜çš„åŒºåŸŸå‘ç”Ÿè‚ºç™Œçš„æœºç‡ä½ï¼Œç›¸åï¼Œæ”¶å…¥ä½çš„åŒºåŸŸï¼Œå‘ç”Ÿè‚ºç™Œçš„æœºç‡é«˜ã€‚ç²—ç•¥çš„è§‚å¯Ÿåªèƒ½å¤Ÿç»™å‡ºä¸€ä¸ªåˆæ­¥ä¸æ˜¯ååˆ†ç¡®å®šçš„åˆ¤æ–­ç»“æœï¼Œå¦‚æœéœ€è¦ä»¥æ•°æ®åˆ†æçš„æ–¹å¼è¯æ˜ä¹‹é—´æ˜¯å¦å­˜åœ¨å…³è”ï¼Œåˆ™éœ€è¦ä½œç›¸å…³æ€§åˆ†æã€‚


```python
pubicHealth_Statistic_mapping={'Community Area':'CommunityArea', 
                                'Community Area Name':'CommunityArea_Name',
                                'Birth Rate':'Birth_Rate',
                                'General Fertility Rate':'General_FertilityRate',
                                'Low Birth Weight':'Low_BirthWeight',
                                'Prenatal Care Beginning in First Trimester':'PrenatalCareBeginning_inFirstTrimester', 
                                'Preterm Births':'Preterm_Births',
                                'Teen Birth Rate':'TeenBirth_Rate',
                                'Assault (Homicide)':'Assault_Homicide',
                                'Breast cancer in females':'BreastCancer_infemales',
                                'Cancer (All Sites)':'Cancer_AllSites', 
                                'Colorectal Cancer':'Colorectal_Cancer',
                                'Diabetes-related':'Diabetes_related',
                                'Firearm-related':'Firearm_related',
                                'Infant Mortality Rate':'InfantMortality_Rate', 
                                'Lung Cancer':'Lung_Cancer',
                                'Prostate Cancer in Males':'ProstateCancer_inMales',
                                'Stroke (Cerebrovascular Disease)':'Stroke_CerebrovascularDisease',
                                'Childhood Blood Lead Level Screening':'ChildhoodBloodLeadLevel_Screening',
                                'Childhood Lead Poisoning':'ChildhoodLead_Poisoning',
                                'Gonorrhea in Females':'Gonorrhea_inFemales', 
                                'Gonorrhea in Males':'Gonorrhea_inMales', 
                                'Tuberculosis':'Tuberculosis',
                                'Below Poverty Level':'BelowPoverty_Level', 
                                'Crowded Housing':'Crowded_Housing', 
                                'Dependency':'Dependency',
                                'No High School Diploma':'NoHighSchool_Diploma', 
                                'Per Capita Income':'PerCapita_Income',
                                'Unemployment':'Unemployment',
                                }

pubicHealth_rename=pubicHealth_gpd.rename(columns=pubicHealth_Statistic_mapping)

pubicHealth_extract_columns=[
       'Birth_Rate','General_FertilityRate', 'Low_BirthWeight',
       'PrenatalCareBeginning_inFirstTrimester', 'Preterm_Births',
       'TeenBirth_Rate', 'Assault_Homicide', 'BreastCancer_infemales',
       'Cancer_AllSites', 'Colorectal_Cancer', 'Diabetes_related',
       'Firearm_related', 'InfantMortality_Rate', 'Lung_Cancer',
       'ProstateCancer_inMales', 'Stroke_CerebrovascularDisease',
       'ChildhoodBloodLeadLevel_Screening', 'ChildhoodLead_Poisoning',
       'Gonorrhea_inFemales', 'Gonorrhea_inMales', 'Tuberculosis',    
       'BelowPoverty_Level', 'Crowded_Housing', 'Dependency',
       'NoHighSchool_Diploma', 'PerCapita_Income', 'Unemployment'    
        ]

pubicHealth_extract=pubicHealth_rename[pubicHealth_extract_columns].select_dtypes(include=np.number)
publicHealth_correlation=pubicHealth_extract.corr()
print_html(publicHealth_correlation)
```




<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Birth_Rate</th>
      <th>General_FertilityRate</th>
      <th>Low_BirthWeight</th>
      <th>PrenatalCareBeginning_inFirstTrimester</th>
      <th>Preterm_Births</th>
      <th>TeenBirth_Rate</th>
      <th>Assault_Homicide</th>
      <th>BreastCancer_infemales</th>
      <th>Cancer_AllSites</th>
      <th>Colorectal_Cancer</th>
      <th>Diabetes_related</th>
      <th>Firearm_related</th>
      <th>InfantMortality_Rate</th>
      <th>Lung_Cancer</th>
      <th>ProstateCancer_inMales</th>
      <th>Stroke_CerebrovascularDisease</th>
      <th>ChildhoodBloodLeadLevel_Screening</th>
      <th>ChildhoodLead_Poisoning</th>
      <th>Gonorrhea_inFemales</th>
      <th>Tuberculosis</th>
      <th>BelowPoverty_Level</th>
      <th>Crowded_Housing</th>
      <th>Dependency</th>
      <th>NoHighSchool_Diploma</th>
      <th>PerCapita_Income</th>
      <th>Unemployment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Birth_Rate</th>
      <td>1.000000</td>
      <td>0.810334</td>
      <td>0.108179</td>
      <td>-0.178847</td>
      <td>0.004334</td>
      <td>0.612710</td>
      <td>0.188536</td>
      <td>-0.022201</td>
      <td>-0.001289</td>
      <td>-0.097507</td>
      <td>0.303831</td>
      <td>0.162722</td>
      <td>0.051716</td>
      <td>-0.063567</td>
      <td>0.130114</td>
      <td>0.126423</td>
      <td>0.481725</td>
      <td>0.210016</td>
      <td>0.126671</td>
      <td>0.279755</td>
      <td>0.249764</td>
      <td>0.603219</td>
      <td>0.115771</td>
      <td>0.594249</td>
      <td>-0.377653</td>
      <td>0.149439</td>
    </tr>
    <tr>
      <th>General_FertilityRate</th>
      <td>0.810334</td>
      <td>1.000000</td>
      <td>0.142189</td>
      <td>-0.134292</td>
      <td>0.122235</td>
      <td>0.655528</td>
      <td>0.293843</td>
      <td>0.058089</td>
      <td>0.164279</td>
      <td>0.022977</td>
      <td>0.352294</td>
      <td>0.285562</td>
      <td>0.165320</td>
      <td>0.026357</td>
      <td>0.196524</td>
      <td>0.241311</td>
      <td>0.490693</td>
      <td>0.303624</td>
      <td>0.250984</td>
      <td>0.144972</td>
      <td>0.173846</td>
      <td>0.655826</td>
      <td>0.524558</td>
      <td>0.714008</td>
      <td>-0.661131</td>
      <td>0.275589</td>
    </tr>
    <tr>
      <th>Low_BirthWeight</th>
      <td>0.108179</td>
      <td>0.142189</td>
      <td>1.000000</td>
      <td>-0.532546</td>
      <td>0.843100</td>
      <td>0.622936</td>
      <td>0.747493</td>
      <td>0.425041</td>
      <td>0.759791</td>
      <td>0.657992</td>
      <td>0.664107</td>
      <td>0.671880</td>
      <td>0.677792</td>
      <td>0.671295</td>
      <td>0.713754</td>
      <td>0.525439</td>
      <td>0.416265</td>
      <td>0.388319</td>
      <td>0.737727</td>
      <td>0.125231</td>
      <td>0.681049</td>
      <td>-0.080532</td>
      <td>0.479581</td>
      <td>0.056962</td>
      <td>-0.394564</td>
      <td>0.702227</td>
    </tr>
    <tr>
      <th>PrenatalCareBeginning_inFirstTrimester</th>
      <td>-0.178847</td>
      <td>-0.134292</td>
      <td>-0.532546</td>
      <td>1.000000</td>
      <td>-0.413383</td>
      <td>-0.579170</td>
      <td>-0.591605</td>
      <td>-0.142970</td>
      <td>-0.385923</td>
      <td>-0.315996</td>
      <td>-0.470152</td>
      <td>-0.540972</td>
      <td>-0.466319</td>
      <td>-0.353354</td>
      <td>-0.430259</td>
      <td>-0.395817</td>
      <td>-0.328470</td>
      <td>-0.516579</td>
      <td>-0.653985</td>
      <td>-0.270147</td>
      <td>-0.516145</td>
      <td>-0.074951</td>
      <td>-0.192405</td>
      <td>-0.078027</td>
      <td>0.200858</td>
      <td>-0.542603</td>
    </tr>
    <tr>
      <th>Preterm_Births</th>
      <td>0.004334</td>
      <td>0.122235</td>
      <td>0.843100</td>
      <td>-0.413383</td>
      <td>1.000000</td>
      <td>0.549843</td>
      <td>0.742019</td>
      <td>0.435020</td>
      <td>0.780207</td>
      <td>0.722153</td>
      <td>0.650790</td>
      <td>0.732584</td>
      <td>0.672087</td>
      <td>0.675119</td>
      <td>0.642100</td>
      <td>0.539608</td>
      <td>0.289144</td>
      <td>0.379146</td>
      <td>0.800491</td>
      <td>0.001197</td>
      <td>0.550906</td>
      <td>-0.140244</td>
      <td>0.571350</td>
      <td>-0.023655</td>
      <td>-0.364807</td>
      <td>0.646550</td>
    </tr>
  </tbody>
</table>



é€šè¿‡ä¸Šè¿°ç›¸å…³æ€§è®¡ç®—ï¼Œå·²ç»è®¡ç®—äº†ä¸¤ä¸¤ä¹‹é—´çš„ç›¸å…³ç³»æ•°ã€‚ä¸ºäº†æ›´åŠ æ¸…æ™°çš„æŸ¥çœ‹ç›¸å…³ç³»æ•°ï¼Œå¯ä»¥åŒæ—¶æ‰“å°æ•£ç‚¹å›¾ï¼ˆé€šå¸¸åœ¨è®¡ç®—ç›¸å…³ç³»æ•°å‰æ‰“å°æ•£ç‚¹å›¾ï¼ŒæŸ¥çœ‹ä¸¤ä¸ªå˜é‡é—´çš„çº¿æ€§å…³ç³»ï¼‰ï¼Œæˆ–æŸ¥çœ‹ç›¸å…³ç³»æ•°å˜åŒ–çš„çƒ­åŠ›å›¾ã€‚


```python
import plotly.graph_objects as go

fig = go.Figure(data=go.Splom(
                dimensions=[dict(label=k,values=list(v.values())) for k,v in pubicHealth_extract.to_dict().items()],
                diagonal_visible=False, # remove plots on diagonal
                ))
fig.update_layout(
    title='å…¬å…±å¥åº·æ•°æ®',
    dragmode='select',
    width=1800,
    height=1800,
    hovermode='closest',
)

fig.show()
```

<img src="./imgs/2_1_3/output_42_0.png" height='auto' width='auto' title="caDesign">


```python
import seaborn as sns

plt.figure(figsize=(20, 20))
sns.heatmap(publicHealth_correlation,annot=True, fmt=".2f", linewidths=.5,)
plt.show()
```


<img src="./imgs/2_1_3/output_43_0.png" height='auto' width='auto' title="caDesign">    
  


ä¸ç®¡æ˜¯æ•£ç‚¹å›¾è¿˜æ˜¯çƒ­åŠ›å›¾ï¼Œä»¥åŠç›¸å…³ç³»æ•°çŸ©é˜µï¼Œåœ¨è§‚å¯Ÿå¤šä¸ªä¸¤ä¸¤ä¹‹é—´ç›¸å…³æ€§æ—¶ï¼Œéƒ½ä¸æ˜¯å¾ˆå®¹æ˜“è§‚å¯Ÿæ‰€å…³æ³¨çš„å¯¹è±¡ã€‚å› æ­¤å¯ä»¥æ ¹æ®åˆ†æçš„ç›®çš„å°†éœ€è¦å…³æ³¨çš„å˜é‡æå–å‡ºæ¥ï¼Œåªå…³æ³¨è¯¥å˜é‡ä¸å…¶å®ƒæ‰€æœ‰å˜é‡çš„ç›¸å…³ç³»æ•°ã€‚


```python
import numpy as np

economic_factors=['BelowPoverty_Level', 'Crowded_Housing', 'Dependency', 'NoHighSchool_Diploma', 'PerCapita_Income', 'Unemployment']
publicHealth_indicator=publicHealth_correlation[economic_factors]
publicHealth_indicator_columns=publicHealth_indicator.T.columns.to_numpy()

plt.rcdefaults()
plt.rcParams.update({'font.size':9})

nrows=3
ncols=2
fig, axs=plt.subplots(nrows=nrows,ncols=ncols,figsize=(10*2, 10*2))  
y_pos=np.arange(len(publicHealth_indicator_columns))

i=0
for idx in [(row,col) for row in range(nrows) for col in range(ncols)]:
    axs[idx].barh(y_pos, publicHealth_indicator[economic_factors[i]].to_numpy(), align='center') 
    axs[idx].set_yticks(y_pos)
    axs[idx].set_yticklabels(publicHealth_indicator_columns)
    axs[idx].invert_yaxis()  # labels read top-to-bottom
    axs[idx].set_xlabel(economic_factors[i])
    # axs.set_title(title_str)
    for index, value in enumerate(publicHealth_indicator[economic_factors[i]].to_numpy()):
        if value>=0:
            axs[idx].text(value, index, str(round(value,2)),horizontalalignment='left')
        else:
            axs[idx].text(value, index, str(round(value,2)),horizontalalignment='right')
    i+=1
    
plt.subplots_adjust(top=0.92, bottom=0.08, left=0.10, right=0.95, hspace=0.1,wspace=0.4)
plt.show()
```


<img src="./imgs/2_1_3/output_45_0.png" height='auto' width='auto' title="caDesign">    
   


è™½ç„¶è®¡ç®—äº†ä¸¤ä¸¤å…¬å…±å¥åº·æŒ‡æ ‡ä¹‹é—´çš„ç›¸å…³ç³»æ•°ï¼Œä½†è¿™å¹¶ä¸ä»£è¡¨è¯¥æ ·æœ¬æ‰€è®¡ç®—å¾—å‡ºçš„ç›¸å…³æ€§èƒ½å¤Ÿåæ˜ æ€»ä½“æ˜¯å¦ä¹Ÿå­˜åœ¨æ ·æœ¬æ‰€å¾—å‡ºçš„ç°è±¡ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦å…³æ³¨å‡è®¾æ£€éªŒè®¡ç®—å¾—å‡ºçš„På€¼ï¼Œå°†På€¼ä¸æ»¡è¶³æ˜¾è‘—æ€§æ°´å¹³ä¸º0.05çš„ä¸¤ä¸¤å˜é‡å‰”é™¤æ‰ï¼Œæ‰€å¾—åˆ°çš„ç»“æœå³ä¸ºèƒ½å¤Ÿåæ˜ æ€»ä½“ç›¸å…³æ€§çš„éƒ¨åˆ†ã€‚é¦–å…ˆç”¨æ‰€å…³æ³¨çš„å˜é‡ä½œä¸ºindexç´¢å¼•ï¼Œä¸ºæ‰€æœ‰çš„ç»æµå˜é‡`economic_factors=['BelowPoverty_Level', 'Crowded_Housing', 'Dependency', 'NoHighSchool_Diploma', 'PerCapita_Income', 'Unemployment']`ï¼Œæ–¹ä¾¿åç»­çš„æ•°æ®åˆ†æã€‚


```python
from scipy import stats

disease_columns=[       
       'Birth_Rate','General_FertilityRate', 'Low_BirthWeight',
       'PrenatalCareBeginning_inFirstTrimester', 'Preterm_Births',
       'TeenBirth_Rate', 'Assault_Homicide', 'BreastCancer_infemales',
       'Cancer_AllSites', 'Colorectal_Cancer', 'Diabetes_related',
       'Firearm_related', 'InfantMortality_Rate', 'Lung_Cancer',
       'ProstateCancer_inMales', 'Stroke_CerebrovascularDisease',
       'ChildhoodBloodLeadLevel_Screening', 'ChildhoodLead_Poisoning',
       'Gonorrhea_inFemales', 'Tuberculosis',
        ]
pubicHealth_pearsonr={}

for factor in economic_factors:
    disease_temp={}
    for disease in disease_columns:
        desease_series=pd.to_numeric(pubicHealth_extract[disease],errors='coerce')
        factor_series=pd.to_numeric(pubicHealth_extract[factor],errors='coerce')
        mask=pd.notna(desease_series)&pd.notna(factor_series)
        
        disease_temp[disease]=stats.pearsonr(pd.to_numeric(factor_series[mask],errors='ignore'),pd.to_numeric(desease_series[mask],errors='ignore'))
    pubicHealth_pearsonr[factor]=disease_temp
pubicHealth_pearsonr_df=pd.DataFrame.from_dict(pubicHealth_pearsonr, orient='index').stack().to_frame(name='corr_pV')

pubicHealth_pearsonr_df['correlation']=pubicHealth_pearsonr_df.corr_pV.apply(lambda row:row[0])
pubicHealth_pearsonr_df['p_value']=pubicHealth_pearsonr_df.corr_pV.apply(lambda row:row[1])

print_html(pubicHealth_pearsonr_df)
```




<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>corr_pV</th>
      <th>correlation</th>
      <th>p_value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">BelowPoverty_Level</th>
      <th>Birth_Rate</th>
      <td>(0.24976406537114698, 0.028475743860025216)</td>
      <td>0.249764</td>
      <td>2.847574e-02</td>
    </tr>
    <tr>
      <th>General_FertilityRate</th>
      <td>(0.17384625982353086, 0.13051281178487212)</td>
      <td>0.173846</td>
      <td>1.305128e-01</td>
    </tr>
    <tr>
      <th>Low_BirthWeight</th>
      <td>(0.6810485083790098, 9.384671983490509e-12)</td>
      <td>0.681049</td>
      <td>9.384672e-12</td>
    </tr>
    <tr>
      <th>PrenatalCareBeginning_inFirstTrimester</th>
      <td>(-0.5161448655124206, 1.5503295893976403e-06)</td>
      <td>-0.516145</td>
      <td>1.550330e-06</td>
    </tr>
    <tr>
      <th>Preterm_Births</th>
      <td>(0.5509056684724956, 2.086303329322895e-07)</td>
      <td>0.550906</td>
      <td>2.086303e-07</td>
    </tr>
  </tbody>
</table>



ä»¥ç›¸å…³ç³»æ•°çš„å€¼ä¸ºæ¨ªåæ ‡ï¼Œä»¥ç›¸å…³ç³»æ•°å¯¹åº”çš„På€¼ä¸ºçºµåæ ‡ï¼Œä»¥0.05ä½œä¸ºæ˜¾è‘—æ€§æ°´å¹³ï¼Œæ‰“å°æ•£ç‚¹å›¾ï¼Œå¯ä»¥è¾ƒä¸ºç›´è§‚çš„æŸ¥çœ‹å“ªäº›ä¸¤ä¸¤å…¬å…±å¥åº·æŒ‡æ ‡çš„ç›¸å…³ç³»æ•°èƒ½å¤Ÿåæ˜ æˆ–è€…ä¸èƒ½å¤Ÿåæ˜ æ€»ä½“çš„ç°è±¡ã€‚


```python
pubicHealth_pearsonr_resetIdx=pubicHealth_pearsonr_df.reset_index()
significance_level=0.05
fig=plt.figure(figsize=(30, 10))
ax=fig.add_subplot(111, facecolor='#FFFFCC')
X=pubicHealth_pearsonr_resetIdx.correlation
Y=pubicHealth_pearsonr_resetIdx.p_value
ax.plot(X, Y, 'o')
ax.axhline(y=significance_level,color='r',linestyle='--',label='significance_level')
i=0
for x,y in zip (X,Y):
    label=pubicHealth_pearsonr_resetIdx.loc[i].level_0+' : '+pubicHealth_pearsonr_resetIdx.loc[i].level_1
    plt.annotate(label, # this is the text
                 (x,y), # this is the point to label
                 textcoords="offset points", # how to position the text
                 xytext=(0,10), # distance from text to points (x,y)
                 ha='center', # horizontal alignment can be left, right or center
                 rotation=90
                )
    
    i+=1
plt.annotate('alpha level=%.2f'%significance_level,xy=(-0.7,significance_level),xytext=(-0.75, 0.15),arrowprops=dict(facecolor='black', shrink=0.01),horizontalalignment='right',size=15)
plt.xlabel("correlation",fontsize=20)
plt.ylabel("p-value",fontsize=20)    
plt.tick_params(axis='both', labelsize=15)
plt.show()
```


<img src="./imgs/2_1_3/output_49_0.png" height='auto' width='auto' title="caDesign">   


æå–På€¼å°äºç­‰äº0.05çš„æ‰€æœ‰è¡Œï¼Œå¹¶ä»¥æŸ±çŠ¶å›¾çš„å½¢å¼æ‰“å°ç›¸å…³ç³»æ•°ç»“æœã€‚


```python
pubicHealth_pearsonr_alpha=pubicHealth_pearsonr_df[pubicHealth_pearsonr_df.p_value<=0.05]
print_html(pubicHealth_pearsonr_alpha)
```




<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>corr_pV</th>
      <th>correlation</th>
      <th>p_value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">BelowPoverty_Level</th>
      <th>Birth_Rate</th>
      <td>(0.24976406537114698, 0.028475743860025216)</td>
      <td>0.249764</td>
      <td>2.847574e-02</td>
    </tr>
    <tr>
      <th>Low_BirthWeight</th>
      <td>(0.6810485083790098, 9.384671983490509e-12)</td>
      <td>0.681049</td>
      <td>9.384672e-12</td>
    </tr>
    <tr>
      <th>PrenatalCareBeginning_inFirstTrimester</th>
      <td>(-0.5161448655124206, 1.5503295893976403e-06)</td>
      <td>-0.516145</td>
      <td>1.550330e-06</td>
    </tr>
    <tr>
      <th>Preterm_Births</th>
      <td>(0.5509056684724956, 2.086303329322895e-07)</td>
      <td>0.550906</td>
      <td>2.086303e-07</td>
    </tr>
    <tr>
      <th>TeenBirth_Rate</th>
      <td>(0.6600382763346119, 6.598083934767818e-11)</td>
      <td>0.660038</td>
      <td>6.598084e-11</td>
    </tr>
  </tbody>
</table>




```python
import plotly.graph_objects as go
import random

def generate_colors():    
    '''
    function - ç”Ÿæˆé¢œè‰²åˆ—è¡¨æˆ–è€…å­—å…¸
    
    Returns:
        hex_colors_only - 16è¿›åˆ¶é¢œè‰²å€¼åˆ—è¡¨ï¼›list
        hex_colors_dic - é¢œè‰²åç§°ï¼š16è¿›åˆ¶é¢œè‰²å€¼ï¼›dict
        rgb_colors_dic - é¢œè‰²åç§°ï¼š(r,g,b)ï¼›dict
    '''
    import matplotlib
    
    hex_colors_dic={}
    rgb_colors_dic={}
    hex_colors_only=[]
    for name, hex in matplotlib.colors.cnames.items():
        hex_colors_only.append(hex)
        hex_colors_dic[name]=hex
        rgb_colors_dic[name]=matplotlib.colors.to_rgb(hex)
    return hex_colors_only,hex_colors_dic,rgb_colors_dic

generate_colors,_,_=generate_colors()

economic_factors=['BelowPoverty_Level', 'Crowded_Housing', 'Dependency', 'NoHighSchool_Diploma', 'PerCapita_Income', 'Unemployment']
fig = go.Figure()

for idx,data in pubicHealth_pearsonr_alpha.groupby(level=0):
    fig.add_trace(go.Bar(x=disease_columns,
                    y=data.correlation,
                    name=idx,
                    marker_color=random.choice(generate_colors)
                    ))

fig.update_layout(
    title='Public health indicators_correlation,p-value<0.05',
    xaxis_tickfont_size=14,
    yaxis=dict(
        title='correlation)',
        titlefont_size=16,
        tickfont_size=14,
    ),
    barmode='group',
    bargap=0.1, # gap between bars of adjacent location coordinates.
    bargroupgap=0.5 # gap between bars of the same location coordinate.
)
fig.show()
```

<img src="./imgs/2_1_3/output_52_0.png" height='auto' width='auto' title="caDesign">

---

æ³¨é‡Šï¼ˆNotesï¼‰ï¼š

â‘  scipy.stats.tï¼Œa Studentâ€™s T continuous random variable.ï¼ˆ<https://docs.scipy.org/doc/scipy-0.13.0/reference/generated/scipy.stats.t.html>ï¼‰ã€‚

â‘¡ Chicago Data Portalï¼ŒCDPï¼Œä¸ºèŠåŠ å“¥åŸå¼€æ”¾æ•°æ®é—¨æˆ·ï¼Œå¯å…è´¹ä¸‹è½½æ•°æ®ç”¨äºç›¸å…³åˆ†æï¼Œå…¶ä¸­è®¸å¤šæ•°æ®é›†æ¯å¤©è‡³å°‘æ›´æ–°ä¸€æ¬¡æˆ–æ•°æ¬¡ï¼ˆ<https://data.cityofchicago.org/>ï¼‰ã€‚

å‚è€ƒæ–‡çŒ®ï¼ˆReferencesï¼‰:

[1] Timothy C.Urdan(è’‚è«è¥¿â€¢Câ€¢å„ä¸¹),å½­å¿—æ–‡è¯‘.ç™½è¯ç»Ÿè®¡å­¦[M].ä¸­å›½äººæ°‘å¤§å­¦å‡ºç‰ˆç¤¾.2013,12.ç¬¬3ç‰ˆ. <Timothy C. Urdan.Statistics in plain English[M]. New York: Routledge, 2010>.

[2] (æ—¥)é«˜æ¡¥ ä¿¡è‘—,é™ˆåˆšè¯‘.æ ªå¼ä¼šç¤¾TREND-PROæ¼«ç”»åˆ¶ä½œ.æ¼«ç”»ç»Ÿè®¡å­¦[M].ç§‘å­¦å‡ºç‰ˆç¤¾.åŒ—äº¬,2019.8.

[3] Dawn Griffiths.Head First Statistics: A Brain-Friendly Guide[M]. Sebastopol:O'Reilly Media.September, 2008.
